<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Deathnote Writeup" /><meta property="og:locale" content="en" /><meta name="description" content="Preface Hi! this is a walkthrough of the Vulnhub machine Deathnote,One of my favourite anime’s of all time and described by the author as a Straight forward box, ranked Level - easy with a very helpful advice “don’t waste too much time thinking outside the box”. Initially I felt it was too easy to make a writeup about this machine but I encountered some things for the first time while hacking wordpress, and I hope it’ll be of help to you just incase you get stuck;) There are 2 intended ways of gaining Access, I’ll walk you through both ways! The goal is simple…Get Root!" /><meta property="og:description" content="Preface Hi! this is a walkthrough of the Vulnhub machine Deathnote,One of my favourite anime’s of all time and described by the author as a Straight forward box, ranked Level - easy with a very helpful advice “don’t waste too much time thinking outside the box”. Initially I felt it was too easy to make a writeup about this machine but I encountered some things for the first time while hacking wordpress, and I hope it’ll be of help to you just incase you get stuck;) There are 2 intended ways of gaining Access, I’ll walk you through both ways! The goal is simple…Get Root!" /><link rel="canonical" href="/posts/Deathnote/" /><meta property="og:url" content="/posts/Deathnote/" /><meta property="og:site_name" content="Rami3l" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-05-03T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Deathnote Writeup" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-04T09:19:57+01:00","datePublished":"2022-05-03T00:00:00+01:00","description":"Preface Hi! this is a walkthrough of the Vulnhub machine Deathnote,One of my favourite anime’s of all time and described by the author as a Straight forward box, ranked Level - easy with a very helpful advice “don’t waste too much time thinking outside the box”. Initially I felt it was too easy to make a writeup about this machine but I encountered some things for the first time while hacking wordpress, and I hope it’ll be of help to you just incase you get stuck;) There are 2 intended ways of gaining Access, I’ll walk you through both ways! The goal is simple…Get Root!","headline":"Deathnote Writeup","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/Deathnote/"},"url":"/posts/Deathnote/"}</script><title>Deathnote Writeup | Rami3l</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Rami3l"><meta name="application-name" content="Rami3l"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/avi.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Rami3l</a></div><div class="site-subtitle font-italic">The only true wisdom is in knowing you know nothing.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Rami3ll" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['anonRamiel','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Deathnote Writeup</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Deathnote Writeup</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1651532400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> May 3, 2022 </em> </span> <span> Updated <em class="" data-ts="1651652397" data-df="ll" data-toggle="tooltip" data-placement="bottom"> May 4, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/username">Johnson Daniel Olamide</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1731 words"> <em>9 min</em> read</span></div></div></div><div class="post-content"><h3 id="preface"><span class="mr-2">Preface</span><a href="#preface" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Hi! this is a walkthrough of the Vulnhub machine <a href="https://www.vulnhub.com/entry/deathnote-1,739/">Deathnote</a>,One of my favourite anime’s of all time and described by the author as a Straight forward box, ranked Level - easy with a very helpful advice “don’t waste too much time thinking outside the box”. Initially I felt it was too easy to make a writeup about this machine but I encountered some things for the first time while hacking wordpress, and I hope it’ll be of help to you just incase you get stuck;) There are 2 intended ways of gaining Access, I’ll walk you through both ways! The goal is simple…Get Root!</p><h3 id="live-host-discovery"><span class="mr-2">Live Host Discovery</span><a href="#live-host-discovery" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Once deployed on a hypervisor, we need to find a way to find our targets ip, this we could do through an arp-scan with netdiscover or the arp-scan command utility::</p><ul><li>with arp-scan</ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>┌──(azazel㉿azazel)-[~/Vulnhub/Deathnote]
└─$ sudo arp-scan 192.168.0.124/24
Interface: wlan0, type: EN10MB, MAC: e4:b3:18:45:da:c6, IPv4: 192.168.0.124
WARNING: host part of 192.168.0.124/24 is non-zero
Starting arp-scan 1.9.7 with 256 hosts (https://github.com/royhills/arp-scan)
192.168.0.1	c8:ea:f8:dd:9b:fb	zte corporation
192.168.0.192	08:00:27:a5:27:3e	PCS Systemtechnik GmbH

2 packets received by filter, 0 packets dropped by kernel
Ending arp-scan 1.9.7: 256 hosts scanned in 2.015 seconds (127.05 hosts/sec). 2 responded
</pre></table></code></div></div><ul><li>Or with netdiscover</ul><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>sudo netdiscover -i wlan0 -r 192.x.x.x/24
</pre></table></code></div></div><blockquote><p>The above methods function through the same procedure of flooding the subnet with arp-requests, and any hosts active would reply with an arp-reply.</p></blockquote><h3 id="reconaissance-port-scan"><span class="mr-2">Reconaissance: Port Scan</span><a href="#reconaissance-port-scan" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>To enumerate for services on our target::</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
</pre><td class="rouge-code"><pre>┌──(azazel㉿azazel)-[~/Vulnhub/Deathnote]
└─$ nmap -sCV 192.168.0.192 -p- --min-rate 2000 -vv --open                                                                                                                                                                              130 ⨯
Starting Nmap 7.92 ( https://nmap.org ) at 2022-05-02 18:21 WAT
NSE: Loaded 155 scripts for scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 18:21
Completed NSE at 18:21, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 18:21
Completed NSE at 18:21, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 18:21
Completed NSE at 18:21, 0.00s elapsed
Initiating Ping Scan at 18:21
Scanning 192.168.0.192 [2 ports]
Completed Ping Scan at 18:21, 0.00s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 18:21
Completed Parallel DNS resolution of 1 host. at 18:21, 0.01s elapsed
Initiating Connect Scan at 18:21
Scanning deathnote (192.168.0.192) [65535 ports]
Discovered open port 22/tcp on 192.168.0.192
Discovered open port 80/tcp on 192.168.0.192
Completed Connect Scan at 18:21, 1.33s elapsed (65535 total ports)
Initiating Service scan at 18:21
Scanning 2 services on deathnote (192.168.0.192)
Completed Service scan at 18:21, 6.02s elapsed (2 services on 1 host)
NSE: Script scanning 192.168.0.192.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 18:21
Completed NSE at 18:21, 0.25s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 18:21
Completed NSE at 18:21, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 18:21
Completed NSE at 18:21, 0.00s elapsed
Nmap scan report for deathnote (192.168.0.192)
Host is up, received syn-ack (0.00018s latency).
Scanned at 2022-05-02 18:21:15 WAT for 8s
Not shown: 65533 closed tcp ports (conn-refused)
PORT   STATE SERVICE REASON  VERSION
22/tcp open  ssh     syn-ack OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)
| ssh-hostkey: 
|   2048 5e:b8:ff:2d:ac:c7:e9:3c:99:2f:3b:fc:da:5c:a3:53 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCm89TpyON8aYXST7z9QwF/lZeqXiejtLOaVDmyxME7S2M1Z+57KxnB8ixV0MArX+cNTWO92xYlTiYKIKusPwrB43AArYrnHTLUg79N59GhbreA8yX2xxwuJq/+tu2ieMS7QORyKJVZCRwV/EVHknQyg+jrXLtD74C869l9wb3S9yIeSK1UGNrbdAgOPZtG4pFFRcKghC4wtuukqaE7uIv4yO8mHOo+p+V8+Ab3tbmIG2KZLbb3hW3vjKc4XxBnoJTWwsX6zkV/1HnfE+ptFzs0sHWpyiAKtUGs4AkfymcG5SDyuAkBBiABpBbzBK/Lzcjhb7dJGpqPac+M+lxIb+T1
|   256 a8:f3:81:9d:0a:dc:16:9a:49:ee:bc:24:e4:65:5c:a6 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBCh/urbdjg8yYyJTf6zXc0OVNr9nZ8BXv26XthpOdSCdnIMLKNmlAbONw9KKJ05/BS/7T+zg/LHdA5FAAHL8OFw=
|   256 4f:20:c3:2d:19:75:5b:e8:1f:32:01:75:c2:70:9a:7e (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAII9njk3MGTFBM1ueTjfLjhVUE0a485AyO7kFm0enSRap
80/tcp open  http    syn-ack Apache httpd 2.4.38 ((Debian))
| http-methods: 
|_  Supported Methods: OPTIONS HEAD GET POST
|_http-title: Site doesn't have a title (text/html).
|_http-server-header: Apache/2.4.38 (Debian)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

NSE: Script Post-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 18:21
Completed NSE at 18:21, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 18:21
Completed NSE at 18:21, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 18:21
Completed NSE at 18:21, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 8.11 seconds
</pre></table></code></div></div><p>On visiting port 80, the ip automatically resolves to a “www.deathnote.vuln/wordpress/” and the page doesn’t load,</p><blockquote><p>In simple terms, this is as a result of a resolution conflict by DNS not recognising that site as the bearer of the ip.</p></blockquote><p><img data-src="/assets/img/posts/vulnhub/Deathnote/site.png" alt="image" data-proofer-ignore></p><p>Easy fix! we would need to override this DNS resolution by including the ip and host name in our /etc/hosts file like this:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>sudo echo "$ip deathnote.vuln" &gt;&gt; /etc/hosts
</pre></table></code></div></div><p>Or vim or Nano into the file with sudo and edit the file:</p><p><img data-src="/assets/img/posts/vulnhub/Deathnote/2hosts.png" alt="image" data-proofer-ignore></p><p>Awesome, “It works!” ;) another really funny thing is the /wordpress/ directory gave it away as a wordpress site without a directory enumeration, we are in for a world of fun man!</p><p><img data-src="/assets/img/posts/vulnhub/Deathnote/3site.png" alt="image" data-proofer-ignore></p><p>Lying carelessly in the comments section is kira’s creds, Light should know better yunno</p><p><img data-src="/assets/img/posts/vulnhub/Deathnote/4creds.png" alt="image" data-proofer-ignore></p><p>awesome, we got creds, I just let dirsearch loose in the background so we don’t miss anything and to find an admin login page! By default it’s always <code class="language-plaintext highlighter-rouge">/wp-admin/</code> tried out the creds we have for a user “kira” on ssh, didn’t work.</p><p><img data-src="/assets/img/posts/vulnhub/Deathnote/dirsearch.png" alt="image" data-proofer-ignore></p><p>But on the admin page it does:</p><p><img data-src="/assets/img/posts/vulnhub/Deathnote/5login.png" alt="image" data-proofer-ignore></p><p>Awesome, we have full access to admin dashboard, definitely we would have access to editor tools, to spawn a reverse shell could happen in so many ways, we could either:</p><ul><li>upload a vulnerable plugin or theme and exploit it<li>use the editor feature to edit on of the many php files within either the editor or plugin section<li>Or upload a shell as a plugin in zip format.</ul><p>I prefer the second, no stress, just edit any php file by replacing with reverse shellcode from and navigate to it to generate a reverse shell callback to our attack machine lets get to it! you could grab a php shell code <a href="https://github.com/pentestmonkey/php-reverse-shell">here</a> or your go-to reverse shellcode and edit a php file like so:</p><p><img data-src="/assets/img/posts/vulnhub/Deathnote/theme-edit.png" alt="image" data-proofer-ignore></p><p>on clicking update file, I come across a weird error, which is what spiced up this box a little:</p><blockquote><p>Unable to communicate back with site to check for fatal errors, so the PHP change was reverted. You will need to upload your PHP file change by some other means, such as by using SFTP.</p></blockquote><p>I guess this was as a result of the site being able to detect a “poorly coded” theme or plugin, at least from the viewpoint of WordPress Core. read more about this error <a href="https://stackoverflow.com/questions/52671255/wordpress-editor-not-updating-files-unable-to-communicate-back-with-site-to-che">here</a></p><h3 id="exploitation"><span class="mr-2">Exploitation</span><a href="#exploitation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>After much playing around and a bunch of fails with plugins(this deactivate, edit and activate doesn’t work on plugins or at least it didn’t for me), I was able to bypass this by deactivating the theme whose php file I wish to replace with shellcode, I used the Twenty Twenty::</p><p><img data-src="/assets/img/posts/vulnhub/Deathnote/theme-deactivate.png" alt="image" data-proofer-ignore></p><p>And then editing and updating the php file into our shell code(whilst inactive) and then reactivate it back::</p><p><img data-src="/assets/img/posts/vulnhub/Deathnote/shell.png" alt="image" data-proofer-ignore> <img data-src="/assets/img/posts/vulnhub/Deathnote/edit-success.png" alt="image" data-proofer-ignore></p><p>It allows us successfully edit a theme while it’s deactivated!</p><p><img data-src="/assets/img/posts/vulnhub/Deathnote/theme-activate.png" alt="image" data-proofer-ignore></p><p>And finally, after setting up a listener to activate the shell and generate our callback, we could navigate to a page which doesn’t exist OR navigate to the 404.php page; I prefer terminal::</p><p><img data-src="/assets/img/posts/vulnhub/Deathnote/shell-activate.png" alt="image" data-proofer-ignore></p><h3 id="initial-access"><span class="mr-2">Initial Access</span><a href="#initial-access" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Hell yeah, we got a shell! But not a stable one(check out my <a href="">tty cheatsheet here</a> if you have issues with shell stabilization) if you’re not so sure you could use the <code class="language-plaintext highlighter-rouge">tty</code> cmd let’s get a stable tty:: <img data-src="/assets/img/posts/vulnhub/Deathnote/tty.png" alt="image" data-proofer-ignore></p><p>In Kira’s home dir, we have a kira.txt file but is unreadable <em>sigh</em> One amazing thing about wordpress sites is that it saves MySQL backups for the base configuration files of the wordpress site in the same dirctory as the resources where the site runs on! (<code class="language-plaintext highlighter-rouge">/var/www/html/wordpress</code>)called wp-config.php always search for this first, it usually contains a user creds.</p><p><img data-src="/assets/img/posts/vulnhub/Deathnote/creds.png" alt="image" data-proofer-ignore></p><p>we get L’s creds from here! now we can login over ssh. <img data-src="/assets/img/posts/vulnhub/Deathnote/ssh.png" alt="image" data-proofer-ignore></p><p>On login we meet a note L left us in brainfuck, decode that and we have::</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>i think u got the shell , but you wont be able to kill me -kira
</pre></table></code></div></div><h3 id="www-data-turnt-r00t"><span class="mr-2">www-data turnt r00t!</span><a href="#www-data-turnt-r00t" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Welp Kira has no sudo permissions, neither does he have any SUID binaries and even after scp..ing a privesc enumeration script I had nothing other than kernel exploits, after much playing around, I found a “misa” file in the /var directory the misa file just says:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>l@deathnote:~$ cd /var
l@deathnote:/var$ ls
backups  cache  lib  local  lock  log  mail  misa  opt  run  spool  tmp  www
l@deathnote:/var$ cat misa
it is toooo late for misa 
l@deathnote:/var$ 
</pre></table></code></div></div><p>And an L folder in the /opt directory with a wav file telling us to use cyber chef, say no more: <img data-src="/assets/img/posts/vulnhub/Deathnote/hint.png" alt="image" data-proofer-ignore></p><p>The highest numeric is 9 and the highest alphabet is f beyond reasonable doubt we have a Hex sequence here! decode that:: <img data-src="/assets/img/posts/vulnhub/Deathnote/wav.png" alt="image" data-proofer-ignore></p><p>We get a base64 text, convert that:: <img data-src="/assets/img/posts/vulnhub/Deathnote/kira.png" alt="image" data-proofer-ignore></p><p>and we have Kira’s creds!</p><p>Now we just login over ssh as kira: <img data-src="/assets/img/posts/vulnhub/Deathnote/kira-login.png" alt="image" data-proofer-ignore></p><p>We finally have sufficient privileges to read our kira.txt file, which just has a base64 encoded text again::</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>┌──(azazel㉿azazel)-[~/Utils]
└─$ echo -n cGxlYXNlIHByb3RlY3Qgb25lIG9mIHRoZSBmb2xsb3dpbmcgCjEuIEwgKC9vcHQpCjIuIE1pc2EgKC92YXIp | base64 -d
please protect one of the following 
1. L (/opt)
2. Misa (/var)             
</pre></table></code></div></div><p>We already know whats in the misa file and the L folder, next up, let’s get root! checking sudo permissions, Kira can run everything with sudo!</p><p><img data-src="/assets/img/posts/vulnhub/Deathnote/root.png" alt="image" data-proofer-ignore> Rooooooooooooooted.</p><h2 id="second-intended"><span class="mr-2">Second Intended</span><a href="#second-intended" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Man I found a clue that completely flew over my head until I gained foothold, maybe cause I was itchy to use a webshell haha, but here goes nothing:: checking the robots.txt…<code class="language-plaintext highlighter-rouge">$ip/robots.txt</code> we have a clue:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>fuck it my dad 
added hint on /important.jpg

ryuk please delete it
</pre></table></code></div></div><p>From directory enum, we had an uploads folder,<code class="language-plaintext highlighter-rouge">$ip/wordpress/wp-content/uploads/2021/07</code> we could check for our “important.jpg” there were so many images and none such a name, I just ignored those and went after the two suspicious text files::</p><p><img data-src="/assets/img/posts/vulnhub/Deathnote/uploads.png" alt="image" data-proofer-ignore></p><p>The notes.txt file contain possible passwords and the user.txt contains possible users, we could grab those and bruteforce ssh with hydra!</p><p><img data-src="/assets/img/posts/vulnhub/Deathnote/hydra.png" alt="image" data-proofer-ignore></p><p>Boom we got L’s creds! now just login as L go to /opt get Kira’s creds, login as kira and become root!</p><p>Greetings, from Rami3l.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/vulnhub/'>Vulnhub</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/wordpress/" class="post-tag no-text-decoration" >wordpress</a> <a href="/tags/webshell/" class="post-tag no-text-decoration" >webshell</a> <a href="/tags/sensitive-information-disclosure/" class="post-tag no-text-decoration" >sensitive information disclosure</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Deathnote+Writeup+-+Rami3l&url=%2Fposts%2FDeathnote%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Deathnote+Writeup+-+Rami3l&u=%2Fposts%2FDeathnote%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Fposts%2FDeathnote%2F&text=Deathnote+Writeup+-+Rami3l" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Paper-writeup/">Paper writeup</a><li><a href="/posts/Deathnote/">Deathnote Writeup</a><li><a href="/posts/NahamConCTF/">NahamCon 2022 CTF - challenge walkthrough</a><li><a href="/posts/TenderFoot/">TenderFoot:1 Writeup</a><li><a href="/posts/BoilerCTF-Writeup/">BoilerCTF Walkthrough</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/command-injection/">Command Injection</a> <a class="post-tag" href="/tags/enumeration/">Enumeration</a> <a class="post-tag" href="/tags/brainfuck/">Brainfuck</a> <a class="post-tag" href="/tags/bruteforce/">Bruteforce</a> <a class="post-tag" href="/tags/cms/">CMS</a> <a class="post-tag" href="/tags/ctfs/">ctfs</a> <a class="post-tag" href="/tags/cve/">CVE</a> <a class="post-tag" href="/tags/directory-enumeration/">Directory Enumeration</a> <a class="post-tag" href="/tags/dirsearch/">Dirsearch</a> <a class="post-tag" href="/tags/esoteric-languages/">Esoteric Languages</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/TenderFoot/"><div class="card-body"> <em class="small" data-ts="1651359600" data-df="ll" > May 1, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TenderFoot:1 Writeup</h3><div class="text-muted small"><p> Preface Hey there! This is my writeup for the Vulnhub machine TenderFoot, Its described by it’s author as “A very Easy Box for beginners”, and is recommended for folks new to Vulnhub like myself. ...</p></div></div></a></div><div class="card"> <a href="/posts/Paper-writeup/"><div class="card-body"> <em class="small" data-ts="1654038000" data-df="ll" > Jun 1, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Paper writeup</h3><div class="text-muted small"><p> Premise Hey, this is my writeup for the Hackthebox machine; paper, my first HTB non starting point machine and took me a day to finish mostly due to bad internet lmao. Enumeration As always, lets ...</p></div></div></a></div><div class="card"> <a href="/posts/NahamConCTF/"><div class="card-body"> <em class="small" data-ts="1651359600" data-df="ll" > May 1, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>NahamCon 2022 CTF - challenge walkthrough</h3><div class="text-muted small"><p> PREFACE Considering how big of a fan I am of Naham and John Hammond, this ctf was quit a big deal to me! it was so much fun and involved categories which I really liked like malware analysis, event...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/TenderFoot/" class="btn btn-outline-primary" prompt="Older"><p>TenderFoot:1 Writeup</p></a> <a href="/posts/Paper-writeup/" class="btn btn-outline-primary" prompt="Newer"><p>Paper writeup</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/username">Johnson Daniel Olamide</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/command-injection/">Command Injection</a> <a class="post-tag" href="/tags/enumeration/">Enumeration</a> <a class="post-tag" href="/tags/brainfuck/">Brainfuck</a> <a class="post-tag" href="/tags/bruteforce/">Bruteforce</a> <a class="post-tag" href="/tags/cms/">CMS</a> <a class="post-tag" href="/tags/ctfs/">ctfs</a> <a class="post-tag" href="/tags/cve/">CVE</a> <a class="post-tag" href="/tags/directory-enumeration/">Directory Enumeration</a> <a class="post-tag" href="/tags/dirsearch/">Dirsearch</a> <a class="post-tag" href="/tags/esoteric-languages/">Esoteric Languages</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3"></p><button type="button" class="btn btn-primary" aria-label="Update"> </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
